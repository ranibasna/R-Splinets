<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Indefinite integrals of splines — integra • Splinets</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Indefinite integrals of splines — integra"><meta name="description" content="The function generates the indefinite integrals for given input splines.
The integral is a function
of the upper limit of the definite integral and is a spline of the higher order that does not satisfy the zero boundary conditions at the RHS endpoint,
unless the definite integral over the whole range is equal to zero.
Moreover, the support of the function is extended in the RHS up to the RHS end point
unless the definite integral of the input is zero, in which the case the support is extracted from the obtained spline."><meta property="og:description" content="The function generates the indefinite integrals for given input splines.
The integral is a function
of the upper limit of the definite integral and is a spline of the higher order that does not satisfy the zero boundary conditions at the RHS endpoint,
unless the definite integral over the whole range is equal to zero.
Moreover, the support of the function is extended in the RHS up to the RHS end point
unless the definite integral of the input is zero, in which the case the support is extracted from the obtained spline."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Splinets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ImageClassification.html">Image Classification with Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/MassSpectrometry.html">Splinets Statistical Application: mass spectrometry</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Indefinite integrals of splines</h1>

      <div class="d-none name"><code>integra.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function generates the indefinite integrals for given input splines.
The integral is a function
of the upper limit of the definite integral and is a spline of the higher order that does not satisfy the zero boundary conditions at the RHS endpoint,
unless the definite integral over the whole range is equal to zero.
Moreover, the support of the function is extended in the RHS up to the RHS end point
unless the definite integral of the input is zero, in which the case the support is extracted from the obtained spline.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">integra</span><span class="op">(</span><span class="va">object</span>, epsilon <span class="op">=</span> <span class="fl">1e-07</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>a <code>Splinets</code> object of the smoothness order <code>k</code>;</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>non-negative number indicating accuracy when close to zero value are detected; This accuracy is used in
when the boundary conditions of the integral are checked.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>Splinets</code>-object with order <code>k+1</code> that contains the indefinite integrals
of the input object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The value on the RHS is not zero, so the zero boundary condition typically is not satisfied and the support is
is extended to the RHS end of the whole domain of splines. However, the function returns proper support
if the original spline is a derivative of a spline that satisfies the boundary conditons.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Liu, X., Nassar, H., Podg\(\mbox{\'o}\)rski, K. "Dyadic diagonalization of positive definite band matrices and efficient B-spline orthogonalization." Journal of Computational and Applied Mathematics (2022) &lt;https://doi.org/10.1016/j.cam.2022.114444&gt;.</p>

<p>Podg\(\mbox{\'o}\)rski, K. (2021)
"<code>Splinets</code> – splines through the Taylor expansion, their support sets and orthogonal bases." &lt;arXiv:2102.00733&gt;.</p>
<p>Nassar, H., Podg\(\mbox{\'o}\)rski, K. (2023) "Splinets 1.5.0 – Periodic Splinets." &lt;arXiv:2302.07552&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="deriva.html">deriva</a></code> for computing derivatives of splines; <code><a href="dintegra.html">dintegra</a></code> for the definite integral;</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#--- Generate indefinite integral ---#</span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">18</span>; <span class="va">k</span><span class="op">=</span><span class="fl">3</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>; <span class="va">xi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>; <span class="va">xi</span><span class="op">[</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="co"># generate a random matrix S</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">S</span><span class="op">)</span> <span class="co">#constructing a spline</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The spline 1 'ths highest derivative at the two central knots has been made equal by averaging SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The derivative matrix for spline 1 does not satisfy the smoothness conditions (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The standard error per matrix entry is 1.292652 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 2 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 2 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="integra-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dspl</span> <span class="op">=</span> <span class="fu"><a href="deriva.html">deriva</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span> <span class="co">#derivative</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dspl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="integra-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">dspl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 20 non-equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: Not the full range support, a single support interval for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.059186e-20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="dintegra.html">dintegra</a></span><span class="op">(</span><span class="va">dspl</span><span class="op">)</span> <span class="co">#the definite integral is 0 (the boundary conditions for 'spl')</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Spline ID    dIntegral</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]         1 1.250736e-15</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ispl</span> <span class="op">=</span> <span class="fu">integra</span><span class="op">(</span><span class="va">spl</span><span class="op">)</span> <span class="co">#the integral of a spline</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ispl</span><span class="op">)</span> <span class="co">#the boundary condition on the rhs not satisfied (non-zero value)</span></span></span>
<span class="r-plt img"><img src="integra-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">ispl</span><span class="op">@</span><span class="va">smorder</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-in"><span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">ispl</span><span class="op">)</span> <span class="co">#the object does not satisfy the boundary condition for the spline</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The derivative matrix for spline 1 does not satisfy the smoothness conditions (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The standard error per matrix entry is 0.001738661 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 20 non-equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: The full support range for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0002176519</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spll</span> <span class="op">=</span> <span class="fu">integra</span><span class="op">(</span><span class="va">dspl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spll</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="integra-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">spll</span><span class="op">)</span> <span class="co">#the boundary conditions of the integral of the derivative satisfied.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 20 non-equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: The full support range for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.059186e-20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#----------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#--- Examples with different support ranges ---#</span></span></span>
<span class="r-in"><span><span class="co">#----------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">25</span>; <span class="va">k</span><span class="op">=</span><span class="fl">2</span>; </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>; <span class="va">xi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>; <span class="va">xi</span><span class="op">[</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="co">#Defining support ranges for three splines</span></span></span>
<span class="r-in"><span><span class="va">supp</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">4</span>,<span class="fl">20</span>,<span class="fl">6</span>,<span class="fl">25</span><span class="op">)</span>,byrow<span class="op">=</span><span class="cn">TRUE</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Initial random matrices of the derivative for each spline</span></span></span>
<span class="r-in"><span><span class="va">SS1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">supp</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">supp</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">SS2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">supp</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">supp</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">SS3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">supp</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">supp</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">SS1</span>,<span class="va">supp</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span> <span class="co">#constructing the first proper spline</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 1 's highest derivative at the central knot is not zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Now it is set to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the splie conditions (up to the accuracy set in SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.576956 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 4 knots, the first 1 entries of the 4 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 4 knots, the first 1 entries of the 4 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span><span class="va">nspl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">SS2</span>,<span class="va">supp</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span>,<span class="st">'CRFC'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method CRFC to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 1 's highest derivative at the central knot is not zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Now it is set to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the splie conditions (up to the accuracy set in SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.33174 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 4 knots, the first 1 entries of the 4 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 4 knots, the first 1 entries of the 4 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.The zero boundary conditions are not satisfied.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The correction of the first and last rows of the derivative matrix has been made.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The highest order derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> It has been made equal to zero now.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method CRFC .</span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="gather.html">gather</a></span><span class="op">(</span><span class="va">spl</span>,<span class="va">nspl</span><span class="op">)</span> <span class="co">#the second and the first together</span></span></span>
<span class="r-in"><span><span class="va">nspl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">SS3</span>,<span class="va">supp</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span>,<span class="st">'CRLC'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method CRLC to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 1  - highest derivative is not symmetric at the center (equal values at the two central knots).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The two values have been made equal by averaging.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the splie conditions (up to the accuracy set in SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.41863 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.The zero boundary conditions are not satisfied.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The correction of the first and last rows of the derivative matrix has been made.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The highest order derivative is not symmetrically defined at the center.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           The values at the two central knots should be equal.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The highest order derivative values at the two central knots</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           have been made equal by averaging the two central values.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method CRLC .</span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="gather.html">gather</a></span><span class="op">(</span><span class="va">spl</span>,<span class="va">nspl</span><span class="op">)</span> <span class="co">#the third is added</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="integra-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">@</span><span class="va">supp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    4   20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    6   25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dspl</span> <span class="op">=</span> <span class="fu"><a href="deriva.html">deriva</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span> <span class="co">#derivative of the splines</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dspl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="integra-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="dintegra.html">dintegra</a></span><span class="op">(</span><span class="va">dspl</span><span class="op">)</span> <span class="co">#the definite integral over the entire range of knots is zero</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Spline ID     dIntegral</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]         1 -1.665335e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]         2 -8.881784e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]         3 -1.318390e-16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">idspl</span> <span class="op">=</span> <span class="fu">integra</span><span class="op">(</span><span class="va">dspl</span><span class="op">)</span> <span class="co">#integral of the derivative returns the original splines</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">idspl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="integra-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">idspl</span><span class="op">)</span>  <span class="co">#and confirms that the object is a spline with boundary conditions </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 27 non-equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 3 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: Not the full range support, a single support interval for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.481881e-22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>                    <span class="co">#satified</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">idspl</span><span class="op">@</span><span class="va">supp</span> <span class="co">#Since integral is taken over a function that integrates to zero over </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    4   20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    6   25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">spl</span><span class="op">@</span><span class="va">supp</span>  <span class="co">#each of the support interval, the support of all three objects are the same. </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    4   20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    6   25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">dspl</span><span class="op">@</span><span class="va">supp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    4   20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    6   25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ispl</span><span class="op">=</span><span class="fu">integra</span><span class="op">(</span><span class="va">spl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ispl</span><span class="op">)</span> <span class="co">#the zero boundary condition at the RHS-end for the splines are not satisfied.</span></span></span>
<span class="r-plt img"><img src="integra-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">ispl</span><span class="op">)</span> <span class="co">#thus the object is reported as a non-spline</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 2 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 3 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The derivative matrix for spline 1 does not satisfy the smoothness conditions (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The standard error per matrix entry is 0.005288035 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The derivative matrix for spline 2 does not satisfy the smoothness conditions (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The standard error per matrix entry is 0.4265515 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The derivative matrix for spline 3 does not satisfy the smoothness conditions (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The standard error per matrix entry is 0.02196226 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 27 non-equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 3 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: The full support range for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13.68423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="deriva.html">deriva</a></span><span class="op">(</span><span class="va">ispl</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="integra-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">displ</span><span class="op">=</span><span class="fu"><a href="deriva.html">deriva</a></span><span class="op">(</span><span class="va">ispl</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">displ</span><span class="op">@</span><span class="va">supp</span> <span class="co">#Comparison of the supports</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    4   20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    6   25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">spl</span><span class="op">@</span><span class="va">supp</span>   </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    4   20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    6   25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>           <span class="co">#Here the integrals have extended support as it is taken from a function</span></span></span>
<span class="r-in"><span><span class="va">ispl</span><span class="op">@</span><span class="va">supp</span>  <span class="co">#that does not integrate to zero.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#---------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Example with complicated supports---#</span></span></span>
<span class="r-in"><span><span class="co">#---------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">40</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>; <span class="va">k</span><span class="op">=</span><span class="fl">3</span>; </span></span>
<span class="r-in"><span><span class="va">support</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">15</span>,<span class="fl">27</span>,<span class="fl">30</span>,<span class="fl">40</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"Splinets"</span>,knots<span class="op">=</span><span class="va">xi</span>,smorder<span class="op">=</span><span class="va">k</span>,supp<span class="op">=</span><span class="va">support</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co">#the number of knots in the support</span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">der</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#the derivative matrix at random</span></span></span>
<span class="r-in"><span><span class="va">sp1</span> <span class="op">=</span> <span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="co">#Comparison of the corrected and the original 'der' matrices</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 2 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 3 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 1 's highest derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 1 's highest derivative value at the central knot has been made equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.660117 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 2 's highest derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 2 's highest derivative value at the central knot has been made equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 2  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.375712 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 2 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 3 's highest derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 3 's highest derivative value at the central knot has been made equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 3  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.494706 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 3 has the derivative matrix corrected by the RRM method.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">support</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">13</span>,<span class="fl">17</span>,<span class="fl">30</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"Splinets"</span>,knots<span class="op">=</span><span class="va">xi</span>,smorder<span class="op">=</span><span class="va">k</span>,supp<span class="op">=</span><span class="va">support</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co">#the number of knots in the support</span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">der</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#the derivative matrix at random</span></span></span>
<span class="r-in"><span><span class="va">sp2</span> <span class="op">=</span> <span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 2 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1  highest, support 1 's derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.679842 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 2 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1  highest, support 2 's derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 2  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.292027 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 2 has the derivative matrix corrected by the RRM method.</span>
<span class="r-in"><span><span class="va">sp</span> <span class="op">=</span> <span class="fu"><a href="gather.html">gather</a></span><span class="op">(</span><span class="va">sp1</span>,<span class="va">sp2</span><span class="op">)</span> <span class="co">#a group of two splines</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="integra-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">dsp</span> <span class="op">=</span> <span class="fu"><a href="deriva.html">deriva</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span> <span class="co">#derivative</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">dsp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="integra-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spl</span> <span class="op">=</span> <span class="fu">integra</span><span class="op">(</span><span class="va">dsp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span> <span class="co">#the spline retrieved</span></span></span>
<span class="r-plt img"><img src="integra-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">@</span><span class="va">supp</span>  <span class="co">#the supports are retrieved as well</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   15   27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   30   40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   17   30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   15   27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   30   40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   17   30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span> <span class="co">#the proper splinet object that satisfies the boundaries</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 42 equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 2 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: Not the full range support, the number of support intervals varies from 2 to 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.220483e-21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ispl</span> <span class="op">=</span> <span class="fu">integra</span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ispl</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="integra-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">ispl</span><span class="op">@</span><span class="va">supp</span> <span class="co">#full support shown by empty list in SLOT 'supp'</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-in"><span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">ispl</span><span class="op">)</span> <span class="co">#diagnostic confirms no zeros at the boundaries</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 2 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 does not satisfy the conditions </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           One of the reasons can be that SLOT 'taylor' is not correctly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 0.007032306 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  has the derivative matrix corrected by the RRM method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  given that SLOT 'taylor' is properly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 2 does not satisfy the conditions </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           One of the reasons can be that SLOT 'taylor' is not correctly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 0.001073566 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 2  has the derivative matrix corrected by the RRM method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  given that SLOT 'taylor' is properly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 42 equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 2 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: The full support range for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.008096939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spll</span> <span class="op">=</span> <span class="fu"><a href="deriva.html">deriva</a></span><span class="op">(</span><span class="va">ispl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spll</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="integra-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">spll</span><span class="op">@</span><span class="va">supp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   15   27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   30   40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   17   30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xijia Liu, Hiba Nassar, Krzysztof Podgorski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

