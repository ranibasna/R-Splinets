<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Random splines — rspline • Splinets</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Random splines — rspline"><meta name="description" content="The function simulates a random Splinets-object that is made of random splines with the center
at the input spline and the matrix of derivatives has the added error term of the form
$$
\boldsymbol \Sigma^{1/2}\mathbf Z \boldsymbol \Theta^{1/2},
 $$
where  \(\mathbf Z\) is a \((n+2)\times (k+1)\) matrix having iid standard normal variables
as its entries, while \(\boldsymbol \Sigma\) and \(\boldsymbol \Theta\) are matrix parameters.
This matrix error term is then corrected by one of the methods and thus resulting in a matrix of derivatives at knots corresponding to a valid spline."><meta property="og:description" content="The function simulates a random Splinets-object that is made of random splines with the center
at the input spline and the matrix of derivatives has the added error term of the form
$$
\boldsymbol \Sigma^{1/2}\mathbf Z \boldsymbol \Theta^{1/2},
 $$
where  \(\mathbf Z\) is a \((n+2)\times (k+1)\) matrix having iid standard normal variables
as its entries, while \(\boldsymbol \Sigma\) and \(\boldsymbol \Theta\) are matrix parameters.
This matrix error term is then corrected by one of the methods and thus resulting in a matrix of derivatives at knots corresponding to a valid spline."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Splinets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FunctionalPrincipalValueDecomposition.html">Functional Principal Value Decomposition</a></li>
    <li><a class="dropdown-item" href="../articles/ImageClassification.html">Image Classification with Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/IntroductiontoSplinets.html">Introduction to Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/MassSpectrometry.html">Splinets Statistical Application: mass spectrometry</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Random splines</h1>

      <div class="d-none name"><code>rspline.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function simulates a random <code>Splinets</code>-object that is made of random splines with the center
at the input spline and the matrix of derivatives has the added error term of the form
$$
\boldsymbol \Sigma^{1/2}\mathbf Z \boldsymbol \Theta^{1/2},
 $$
where  \(\mathbf Z\) is a \((n+2)\times (k+1)\) matrix having iid standard normal variables
as its entries, while \(\boldsymbol \Sigma\) and \(\boldsymbol \Theta\) are matrix parameters.
This matrix error term is then corrected by one of the methods and thus resulting in a matrix of derivatives at knots corresponding to a valid spline.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rspline</span><span class="op">(</span><span class="va">S</span>, N <span class="op">=</span> <span class="fl">1</span>, Sigma <span class="op">=</span> <span class="cn">NULL</span>, Theta <span class="op">=</span> <span class="cn">NULL</span>, mthd <span class="op">=</span> <span class="st">"RRM"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-s">S<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p><code>Splinets</code>-object with <code>n+2</code> knots and of the order of smoothness <code>k</code>, representing the center of randomly simulated splines;
When the number of splines in the object is bigger than one, only the first spline in the object is used.</p></dd>


<dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>positive integer, size of the sample;</p></dd>


<dt id="arg-sigma">Sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>matrix;</p><ul><li><p>If <code>(n+2)x(n+2)</code> matrix, it controls correlations between derivatives of the same order at different knots.</p></li>
<li><p>If a positive number, it represents a diagonal <code>(n+2)x(n+2)</code> matrix with this number on the diagonal.</p></li>
<li><p>If a <code>n+2</code> vector, it
represents a diagonal <code>(n+2)x(n+2)</code> matrix with the vector entries on the diagonal.</p></li>
<li><p>If <code>NULL</code> (default) represents the identity matrix.</p></li>
</ul></dd>


<dt id="arg-theta">Theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>matrix;</p><ul><li><p>If  <code>(k+1)x(k+1)</code>, this controls correlations between different derivatives at each knot.</p></li>
<li><p>If a positive number, it represents a diagonal matrix with this number on the diagonal.</p></li>
<li><p>If a <code>k+1</code> vector, it
represents a diagonal matrix with the vector entries on the diagonal.</p></li>
<li><p>If  <code>NULL</code> (default), it represents the <code>k+1</code> identity matrix;</p></li>
</ul></dd>


<dt id="arg-mthd">mthd<a class="anchor" aria-label="anchor" href="#arg-mthd"></a></dt>
<dd><p>string, one of the three methods: RCC, CR-LC, CR-FC, to adjust random error matrix so it corresponds to a valid spline;</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>Splinets</code>-object that contains <code>N</code> generated splines constituting an iid sample of splines;</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Liu, X., Nassar, H., Podg\(\mbox{\'o}\)rski, K. "Dyadic diagonalization of positive definite band matrices and efficient B-spline orthogonalization." Journal of Computational and Applied Mathematics (2022) &lt;https://doi.org/10.1016/j.cam.2022.114444&gt;.</p>

<p>Podg\(\mbox{\'o}\)rski, K. (2021)
"<code>Splinets</code> – splines through the Taylor expansion, their support sets and orthogonal bases." &lt;arXiv:2102.00733&gt;.</p>
<p>Nassar, H., Podg\(\mbox{\'o}\)rski, K. (2023) "Splinets 1.5.0 – Periodic Splinets." &lt;arXiv:2302.07552&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="is.splinets.html">is.splinets</a></code> for diagnostics of the <code>Splinets</code>-objects;
<code><a href="construct.html">construct</a></code> for constructing a <code>Splinets</code>-object;
<code><a href="gather.html">gather</a></code>  for combining <code>Splinets</code>-objects into a bigger object;
<code><a href="subsample.html">subsample</a></code>  for subsampling <code>Splinets</code>-objects;
<code><a href="plot-Splinets-method.html">plot,Splinets-method</a></code> for plotting <code>Splinets</code>-objects;</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#-------Simulation of a standard random splinet-------#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">17</span>; <span class="va">k</span><span class="op">=</span><span class="fl">4</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>; <span class="va">xi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>; <span class="va">xi</span><span class="op">[</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span> </span></span>
<span class="r-in"><span><span class="va">S</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">S</span><span class="op">)</span> <span class="co">#Construction of the mean spline</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  The spline 1 'ths highest derivative at the central knot is zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Now it is set to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The derivative matrix for spline 1 does not satisfy the smoothness conditions (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The standard error per matrix entry is 1.480098 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 6 knots, the first 1 entries of the 6 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 6 knots, the first 1 entries of the 6 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">RS</span><span class="op">=</span><span class="fu">rspline</span><span class="op">(</span><span class="va">spl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">graphsp</span><span class="op">=</span><span class="fu"><a href="evspline.html">evspline</a></span><span class="op">(</span><span class="va">RS</span><span class="op">)</span> <span class="co">#Evaluating the random spline</span></span></span>
<span class="r-in"><span><span class="va">meansp</span><span class="op">=</span><span class="fu"><a href="evspline.html">evspline</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">RS</span><span class="op">=</span><span class="fu">rspline</span><span class="op">(</span><span class="va">spl</span>,<span class="fl">5</span><span class="op">)</span> <span class="co">#Five more samples</span></span></span>
<span class="r-in"><span><span class="va">graphsp5</span><span class="op">=</span><span class="fu"><a href="evspline.html">evspline</a></span><span class="op">(</span><span class="va">RS</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">graphsp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">meansp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">graphsp5</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">M</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">graphsp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">meansp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">graphsp5</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">graphsp</span>,type<span class="op">=</span><span class="st">'l'</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">M</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">meansp</span>,col<span class="op">=</span><span class="st">'red'</span>,lwd<span class="op">=</span><span class="fl">3</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co">#the mean spline</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">graphsp5</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">graphsp5</span><span class="op">[</span>,<span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>,col<span class="op">=</span><span class="va">i</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="rspline-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#------------Different construction method------------#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">RS</span><span class="op">=</span><span class="fu">rspline</span><span class="op">(</span><span class="va">spl</span>,<span class="fl">8</span>,mthd<span class="op">=</span><span class="st">'CRLC'</span><span class="op">)</span>; <span class="va">graphsp8</span><span class="op">=</span><span class="fu"><a href="evspline.html">evspline</a></span><span class="op">(</span><span class="va">RS</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">graphsp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">meansp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">graphsp8</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">M</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">graphsp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">meansp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">graphsp8</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">meansp</span>,col<span class="op">=</span><span class="st">'red'</span>,type<span class="op">=</span><span class="st">'l'</span>,lwd<span class="op">=</span><span class="fl">3</span>,lty<span class="op">=</span><span class="fl">2</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">M</span><span class="op">)</span><span class="op">)</span> <span class="co">#the mean spline</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">graphsp8</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">graphsp8</span><span class="op">[</span>,<span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>,col<span class="op">=</span><span class="va">i</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="rspline-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#-------Simulation of with different variances--------#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">Sigma</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">1</span>,<span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span>;<span class="va">Theta</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">1</span>,<span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">RS</span><span class="op">=</span><span class="fu">rspline</span><span class="op">(</span><span class="va">spl</span>,N<span class="op">=</span><span class="fl">10</span>,Sigma<span class="op">=</span><span class="va">Sigma</span><span class="op">)</span> <span class="co">#Ten samples</span></span></span>
<span class="r-in"><span><span class="va">RS2</span><span class="op">=</span><span class="fu">rspline</span><span class="op">(</span><span class="va">spl</span>,N<span class="op">=</span><span class="fl">10</span>,Sigma<span class="op">=</span><span class="va">Sigma</span>,Theta<span class="op">=</span><span class="va">Theta</span><span class="op">)</span> <span class="co">#Ten samples</span></span></span>
<span class="r-in"><span><span class="va">graphsp10</span><span class="op">=</span><span class="fu"><a href="evspline.html">evspline</a></span><span class="op">(</span><span class="va">RS</span><span class="op">)</span>; <span class="va">graphsp102</span><span class="op">=</span><span class="fu"><a href="evspline.html">evspline</a></span><span class="op">(</span><span class="va">RS2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">graphsp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">meansp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">graphsp10</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">M</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">graphsp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">meansp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">graphsp10</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">meansp</span>,type<span class="op">=</span><span class="st">'l'</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">M</span><span class="op">)</span>,col<span class="op">=</span><span class="st">'red'</span>,lwd<span class="op">=</span><span class="fl">3</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">graphsp10</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">graphsp10</span><span class="op">[</span>,<span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>,col<span class="op">=</span><span class="va">i</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="rspline-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">graphsp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">meansp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">graphsp102</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">M</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">graphsp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">meansp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">graphsp102</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">meansp</span>,type<span class="op">=</span><span class="st">'l'</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">M</span><span class="op">)</span>,col<span class="op">=</span><span class="st">'red'</span>,lwd<span class="op">=</span><span class="fl">3</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">graphsp102</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">graphsp102</span><span class="op">[</span>,<span class="va">i</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span>,col<span class="op">=</span><span class="va">i</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="rspline-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#-------Simulation for the mean spline to be----------#</span></span></span>
<span class="r-in"><span><span class="co">#------=----defined on incomplete supports------------#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">43</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>; <span class="va">k</span><span class="op">=</span><span class="fl">3</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>; <span class="va">xi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>; <span class="va">xi</span><span class="op">[</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span>;</span></span>
<span class="r-in"><span><span class="va">support</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">14</span>,<span class="fl">25</span>,<span class="fl">43</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ssp</span><span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"Splinets"</span>,knots<span class="op">=</span><span class="va">xi</span>,supp<span class="op">=</span><span class="va">support</span><span class="op">)</span> <span class="co">#with partial support</span></span></span>
<span class="r-in"><span><span class="va">nssp</span><span class="op">=</span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">ssp</span><span class="op">)</span><span class="op">$</span><span class="va">robject</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The partial support range case.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SLOT 'der' do not have properly set the dimension for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In the output object, it is set temporarily to the matrix of 'ones' with the proper dimension.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">nssp</span><span class="op">@</span><span class="va">smorder</span><span class="op">=</span><span class="fl">3</span> <span class="co">#changing the order of the 'Splinets' object</span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">nssp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">nssp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co">#the number of knots in the support</span></span></span>
<span class="r-in"><span><span class="va">nssp</span><span class="op">@</span><span class="va">der</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co">#the derivative matrix at random</span></span></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">nssp</span><span class="op">)</span><span class="op">$</span><span class="va">robject</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The Taylor expansion coefficient matrix does not have the proper number of columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> It is evaluated now and assigned to the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 2 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 1 's highest derivative at the central knot is not zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Now it is set to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the splie conditions (up to the accuracy set in SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.480395 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 2 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 2 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 2 's highest derivative at the central knot is not zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Now it is set to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 2  does not satisfy the splie conditions (up to the accuracy set in SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.233827 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 2 has the derivative matrix corrected by the RRM method.</span>
<span class="r-in"><span><span class="va">RS</span><span class="op">=</span><span class="fu">rspline</span><span class="op">(</span><span class="va">spl</span>,Sigma<span class="op">=</span><span class="fl">0.05</span>,Theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.3</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">graphsp</span><span class="op">=</span><span class="fu"><a href="evspline.html">evspline</a></span><span class="op">(</span><span class="va">RS</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">meansp</span><span class="op">=</span><span class="fu"><a href="evspline.html">evspline</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">graphsp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">meansp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">graphsp5</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">M</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">graphsp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">meansp</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">graphsp5</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">graphsp</span>,type<span class="op">=</span><span class="st">'l'</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">m</span>,<span class="va">M</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">meansp</span>,col<span class="op">=</span><span class="st">'red'</span>,lwd<span class="op">=</span><span class="fl">3</span>,lty<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co">#the mean spline</span></span></span>
<span class="r-plt img"><img src="rspline-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rani Basna, Xijia Liu, Hiba Nassar, Krzysztof Podgorski, Hanqing Wu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

