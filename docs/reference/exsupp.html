<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Correcting support sets and reshaping the matrix of derivatives at the knots. — exsupp • Splinets</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Correcting support sets and reshaping the matrix of derivatives at the knots. — exsupp"><meta name="description" content="The function is adjusting for a potential reduction in the support sets due to negligibly small values of rows
in the derivative matrix. If the derivative matrix has a row equal to zero (or smaller than a neglible positive value) in the one-sided representation
of it (see the references and sym2one), then the corresponding knot should be removed
from the support set. The function can be used to eliminate the neglible support components from a Splinets-object."><meta property="og:description" content="The function is adjusting for a potential reduction in the support sets due to negligibly small values of rows
in the derivative matrix. If the derivative matrix has a row equal to zero (or smaller than a neglible positive value) in the one-sided representation
of it (see the references and sym2one), then the corresponding knot should be removed
from the support set. The function can be used to eliminate the neglible support components from a Splinets-object."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Splinets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FunctionalPrincipalValueDecomposition.html">Functional Principal Value Decomposition with the Wine data</a></li>
    <li><a class="dropdown-item" href="../articles/ImageClassification.html">Image Classification with Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/IntroductiontoSplinets.html">Introduction to Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/MassSpectrometry.html">Splinets Statistical Application: mass spectrometry</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ranibasna/R-Splinets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Correcting support sets and reshaping the matrix of derivatives at the knots.</h1>
      <small class="dont-index">Source: <a href="https://github.com/ranibasna/R-Splinets/blob/HEAD/R/fun_exsupp.R" class="external-link"><code>R/fun_exsupp.R</code></a></small>
      <div class="d-none name"><code>exsupp.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function is adjusting for a potential reduction in the support sets due to negligibly small values of rows
in the derivative matrix. If the derivative matrix has a row equal to zero (or smaller than a neglible positive value) in the one-sided representation
of it (see the references and <code><a href="sym2one.html">sym2one</a></code>), then the corresponding knot should be removed
from the support set. The function can be used to eliminate the neglible support components from a <code>Splinets</code>-object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">exsupp</span><span class="op">(</span><span class="va">S</span>, supp <span class="op">=</span> <span class="cn">NULL</span>, epsilon <span class="op">=</span> <span class="fl">1e-07</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-s">S<a class="anchor" aria-label="anchor" href="#arg-s"></a></dt>
<dd><p><code>(m+2)x(k+1)</code> matrix, the values of the derivatives at the knots over some input support set
which has the cardinality <code>m+2</code>; The matrix is assumed to be in the symmetric around center form for each component of the support.</p></dd>


<dt id="arg-supp">supp<a class="anchor" aria-label="anchor" href="#arg-supp"></a></dt>
<dd><p><code>NULL</code> or <code>Nsupp x2</code> matrix of integers,  the endpoints indices for
the input support intervals, where <code>Nsupp</code> is the number of the components in the support set; If the parameter is <code>NULL</code>,
than the full support is assumed.</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>small positive number, threshold value of the norm of rows of <code>S</code>; If the norm
of a row of <code>S</code> is less than <code>epsilon</code>, then it will be viewed as a neglible and the knot is excluded from
the inside of the support set.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The list of two elements: <code>exsupp$rS</code> is the reduced derivative matrix from which the neglible rows, if any, have been removed
 and <code>exsupp$rsupp</code> is the corresponding reduced support.
The output matrix has all the support components in the symmetric around the center form, which is how the derivatives are kept in the <code>Splinets</code>-objects.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function typically would be applied to an element in the list given by SLOT
<code>der</code> of a <code>Splinets</code>-object. It eliminates from the support sets regions of negligible values
of a corresponding spline and its derivatives.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Liu, X., Nassar, H., Podg\(\mbox{\'o}\)rski, K. "Dyadic diagonalization of positive definite band matrices and efficient B-spline orthogonalization." Journal of Computational and Applied Mathematics (2022) &lt;https://doi.org/10.1016/j.cam.2022.114444&gt;.</p>

<p>Podg\(\mbox{\'o}\)rski, K. (2021)
"<code>Splinets</code> – splines through the Taylor expansion, their support sets and orthogonal bases." &lt;arXiv:2102.00733&gt;.</p>
<p>Nassar, H., Podg\(\mbox{\'o}\)rski, K. (2023) "Splinets 1.5.0 – Periodic Splinets." &lt;arXiv:2302.07552&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="Splinets-class.html">Splinets-class</a></code> for the description of the <code>Splinets</code>-class;
 <code><a href="sym2one.html">sym2one</a></code> for
switching between the representations of a derivative matrix over a general support set;
<code><a href="lincomb.html">lincomb</a></code> for evaluating a linear transformation of splines in a <code>Splinets</code>-object;
<code><a href="is.splinets.html">is.splinets</a></code> for a diagnostic tool of the <code>Splinets</code>-objects;</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Correcting support sets in a derivative matrix---#</span></span></span>
<span class="r-in"><span><span class="co">#----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">20</span>; <span class="va">k</span><span class="op">=</span><span class="fl">3</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co">#an even number of equally spaced knots </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">S</span><span class="op">)</span> <span class="co">#this spline will be used below to construct a 'sparse' spline</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 does not satisfy the conditions </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           One of the reasons can be that SLOT 'taylor' is not correctly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.303131 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  has the derivative matrix corrected by the RRM method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  given that SLOT 'taylor' is properly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span> <span class="co">#verification</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 22 equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: The full support range for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.237243e-23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="exsupp-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xxi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">20</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co">#large set of knots for construction of a sparse spline </span></span></span>
<span class="r-in"><span><span class="va">nn</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">xxi</span><span class="op">)</span><span class="op">-</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">'Splinets'</span>,knots<span class="op">=</span><span class="va">xxi</span>,smorder<span class="op">=</span><span class="va">k</span><span class="op">)</span> <span class="co">#generic object from the 'Splinets'-class</span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,nrow<span class="op">=</span><span class="op">(</span><span class="va">nn</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co">#starting with zeros everywhere</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span>,<span class="op">]</span><span class="op">=</span><span class="fu"><a href="sym2one.html">sym2one</a></span><span class="op">(</span><span class="va">spl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#assigning local spline to a sparse spline at </span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">nn</span><span class="op">+</span><span class="fl">3</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span><span class="op">=</span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span>,<span class="op">]</span> <span class="co">#the beginning and the same at the end</span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="sym2one.html">sym2one</a></span><span class="op">(</span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,inv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span>                                <span class="co">#at this point the object does not account for the sparsity</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">spspl</span><span class="op">)</span> <span class="co">#a sparse spline on 421 knots with a non-zero terms at the first 22 </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 421 equaly distributed knots between 0 and 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: The full support range for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.319697e-23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span>                   <span class="co">#and at the last 22 knots, the actual support set is not yet reported</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spspl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="exsupp-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spspl</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co">#the local part of the sparse spline</span></span></span>
<span class="r-plt img"><img src="exsupp-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">exsupp</span><span class="op">(</span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#the actual support of the spline given the sparse derivative matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]        [,2]          [,3]          [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.00000000   0.0000000    0.00000000 -7.024458e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -0.12641647  -7.9642378 -334.49798786  1.469705e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -0.62041814  -7.2293915  365.36153367 -7.687523e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -0.68878219   1.4527638   -0.71101105 -2.796661e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.62041412   1.4185891   -0.72432849 -9.844306e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.57139992   0.2679628  -47.60197450  1.003237e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -0.59455541  -0.8613413    0.17120093  3.470285e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -0.63537131  -0.8527954    0.18772610  7.557291e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -0.53976211   7.7245010  360.05872310 -1.397604e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.01522038   9.0243000 -305.46716206  6.403647e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  0.18341751   1.7386151   -0.53160753  5.472878e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  0.26561582   1.7139209   -0.50554621  5.472878e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  0.10491122 -13.5401950 -640.16732427 -1.343290e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] -0.80330481 -14.8951404  583.25961806  2.569197e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] -1.07176004  -1.0095326   -0.06409093 -1.224980e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] -1.11993704  -1.0145600   -0.14705771 -1.742302e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] -1.16157407  -0.5905113   17.95710289  3.801874e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] -1.17579757  -0.1426081    0.85483042 -3.591477e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] -1.18160708  -0.1011358    0.88700587  6.756845e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] -0.98749213  12.4103942  524.59725595  1.099792e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] -0.19762544  12.4504025 -522.91690639 -2.199780e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]  0.00000000   0.0000000    0.00000000  1.098126e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]  0.00000000   0.0000000    0.00000000 -7.024458e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,] -0.12641647  -7.9642378 -334.49798786  1.469705e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,] -0.62041814  -7.2293915  365.36153367 -7.687523e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,] -0.68878219   1.4527638   -0.71101105 -2.796661e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,] -0.62041412   1.4185891   -0.72432849 -9.844306e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,] -0.57139992   0.2679628  -47.60197450  1.003237e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,] -0.59455541  -0.8613413    0.17120093  3.470285e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,] -0.63537131  -0.8527954    0.18772610  7.557291e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31,] -0.53976211   7.7245010  360.05872310 -1.397604e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32,] -0.01522038   9.0243000 -305.46716206  6.403647e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33,]  0.18341751   1.7386151   -0.53160753  5.472878e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34,]  0.26561582   1.7139209   -0.50554621  5.472878e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35,]  0.10491122 -13.5401950 -640.16732427 -1.343290e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36,] -0.80330481 -14.8951404  583.25961806  2.569197e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37,] -1.07176004  -1.0095326   -0.06409093 -1.224980e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [38,] -1.11993704  -1.0145600   -0.14705771 -1.742302e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39,] -1.16157407  -0.5905113   17.95710289  3.801874e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [40,] -1.17579757  -0.1426081    0.85483042 -3.591477e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41,] -1.18160708  -0.1011358    0.88700587  6.756845e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [42,] -0.98749213  12.4103942  524.59725595  1.099792e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43,] -0.19762544  12.4504025 -522.91690639 -2.199780e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [44,]  0.00000000   0.0000000    0.00000000  1.098126e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rsupp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1   22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  400  421</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Expanding the previous spline by building a slightly more complex support set</span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span><span class="op">=</span><span class="fu"><a href="sym2one.html">sym2one</a></span><span class="op">(</span><span class="va">spl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#double the first component of the</span></span></span>
<span class="r-in"><span>                                              <span class="co">#support because these are tangent supports </span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">n</span><span class="op">+</span><span class="fl">3</span><span class="op">)</span><span class="op">+</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="op">]</span><span class="op">=</span><span class="fu"><a href="sym2one.html">sym2one</a></span><span class="op">(</span><span class="va">spl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#tdetect a single component of</span></span></span>
<span class="r-in"><span>                                                <span class="co">#the support with no internal knots removed</span></span></span>
<span class="r-in"><span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">spspl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 421 equaly distributed knots between 0 and 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: The full support range for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.105124e-22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spspl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="exsupp-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">es</span><span class="op">=</span><span class="fu">exsupp</span><span class="op">(</span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">es</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>   <span class="co">#the new support made of three components with the two first ones</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1   43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   44   65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  400  421</span>
<span class="r-in"><span>          <span class="co">#separated by an interval with no knots in it </span></span></span>
<span class="r-in"><span>          </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">es</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>         <span class="co">#defining the spline on the evaluated actual support</span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">es</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co">#Example with reduction of not a full support. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xi1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">14</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>; <span class="va">n1</span><span class="op">=</span><span class="fl">13</span>; <span class="co">#the odd number of equally spaced knots </span></span></span>
<span class="r-in"><span><span class="va">S1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n1</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spl1</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi1</span>,<span class="va">k</span>,<span class="va">S1</span><span class="op">)</span> <span class="co">#construction of a local spline</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative value at the central knot has been made equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 does not satisfy the conditions </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           One of the reasons can be that SLOT 'taylor' is not correctly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.736963 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  has the derivative matrix corrected by the RRM method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  given that SLOT 'taylor' is properly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span><span class="va">xi2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">16</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,<span class="fl">42</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>; <span class="va">n2</span><span class="op">=</span><span class="fl">25</span>; <span class="co">#the odd number of equally spaced knots </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">S2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n2</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spl2</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi2</span>,<span class="va">k</span>,<span class="va">S2</span><span class="op">)</span> <span class="co">#construction of a local spline</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative value at the central knot has been made equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 does not satisfy the conditions </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           One of the reasons can be that SLOT 'taylor' is not correctly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.455238 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  has the derivative matrix corrected by the RRM method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  given that SLOT 'taylor' is properly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>,<span class="op">]</span><span class="op">=</span><span class="fu"><a href="sym2one.html">sym2one</a></span><span class="op">(</span><span class="va">spl1</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">16</span>,<span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">43</span>,<span class="op">]</span><span class="op">=</span><span class="fu"><a href="sym2one.html">sym2one</a></span><span class="op">(</span><span class="va">spl2</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">43</span>,<span class="op">]</span><span class="op">=</span><span class="fu"><a href="sym2one.html">sym2one</a></span><span class="op">(</span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">43</span>,<span class="op">]</span>,inv<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">spspl</span><span class="op">)</span> <span class="co">#three intervals in the support are repported </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 421 equaly distributed knots between 0 and 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: Not the full range support, the number of support intervals varies from 3 to 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 9.544367e-23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">exsupp</span><span class="op">(</span><span class="va">spspl</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">spspl</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]         [,2]          [,3]          [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.00000000   0.00000000  0.000000e+00  6.962683e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.12530473   7.89419798  3.315563e+02 -1.475042e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.61167552   6.95876572 -3.708445e+02  7.759770e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.66223634  -1.90256943 -1.331607e+00  2.880795e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.57013322  -1.96565265 -1.317889e+00  4.792968e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  0.48366223  -1.48498890  2.150577e+01 -4.458285e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  0.42930802  -0.96637928  2.758378e-01  2.991623e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  0.38360809  -0.95290496  2.900836e-01  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  0.33856003  -0.93912474  2.886858e-01 -2.935340e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  0.30282335  -0.38003459  2.319310e+01  4.809927e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  0.30174075   0.13964851 -1.366411e+00 -5.157497e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  0.30683597   0.07423548 -1.380937e+00 -3.050486e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  0.25744444  -3.22725756 -1.372818e+02 -2.853918e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]  0.05155453  -3.24793558  1.364133e+02  5.747596e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]  0.00000000   0.00000000  0.000000e+00 -2.864679e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]  0.00000000   0.00000000  0.000000e+00  4.687346e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]  0.08435637   5.31445157  2.232070e+02 -8.463567e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]  0.43817904   6.34747342 -1.798200e+02  3.797073e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]  0.60489655   2.08968596  9.929753e-01 -5.580409e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]  0.70552119   2.13633780  9.664019e-01 -6.264551e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]  0.80833598   2.18164668  9.365707e-01  2.773512e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]  0.96319963   5.37081712  1.330086e+02 -7.136497e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]  1.24132340   3.61329247 -2.068246e+02  4.357275e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]  1.25730612  -1.29527809  6.646595e-01 -7.460259e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]  1.19636636  -1.26447348  6.291344e-01  1.014451e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,]  1.31943347  10.26719516  4.837009e+02 -1.942446e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,]  2.00718681  11.27738115 -4.412731e+02  9.257870e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]  2.21050562   0.76082567 -4.221931e-01 -1.174983e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,]  2.24625462   0.74058802 -4.277882e-01  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,]  2.28106217   0.72188489 -3.577435e-01  1.470939e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31,]  1.81791045 -30.61381046 -1.315741e+03 -2.762306e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32,] -0.14700936 -31.23514937  1.289645e+03  5.471312e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33,] -0.65938084  -0.51494299  6.034415e-01 -2.706988e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34,] -0.68322103  -0.48641347  5.947985e-01 -1.815019e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35,] -0.67200135   1.66550463  8.978576e+01  1.873010e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36,] -0.54846294   2.31415415 -6.254248e+01 -3.198893e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37,] -0.48567849   0.81621918 -3.707867e-01  1.305606e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [38,] -0.44723610   0.79826007 -3.834962e-01 -2.668994e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39,] -0.40965557   0.78018446 -3.756793e-01  1.641560e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [40,] -0.31677752   4.29989266  1.482034e+02  3.120161e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [41,] -0.06213131   3.91427280 -1.643995e+02 -6.564661e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [42,]  0.00000000   0.00000000  0.000000e+00  3.452389e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [43,]  0.00000000   0.00000000  0.000000e+00 -7.024458e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [44,] -0.12641647  -7.96423781 -3.344980e+02  1.469705e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [45,] -0.62041814  -7.22939148  3.653615e+02 -7.687523e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [46,] -0.68878219   1.45276382 -7.110111e-01 -2.796661e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [47,] -0.62041412   1.41858907 -7.243285e-01 -9.844306e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [48,] -0.57139992   0.26796281 -4.760197e+01  1.003237e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [49,] -0.59455541  -0.86134132  1.712009e-01  3.470285e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [50,] -0.63537131  -0.85279544  1.877261e-01  7.557291e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [51,] -0.53976211   7.72450097  3.600587e+02 -1.397604e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [52,] -0.01522038   9.02430004 -3.054672e+02  6.403647e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [53,]  0.18341751   1.73861505 -5.316075e-01  5.472878e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [54,]  0.26561582   1.71392091 -5.055462e-01  5.472878e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [55,]  0.10491122 -13.54019505 -6.401673e+02 -1.343290e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [56,] -0.80330481 -14.89514043  5.832596e+02  2.569197e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [57,] -1.07176004  -1.00953265 -6.409093e-02 -1.224980e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [58,] -1.11993704  -1.01455999 -1.470577e-01 -1.742302e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [59,] -1.16157407  -0.59051130  1.795710e+01  3.801874e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [60,] -1.17579757  -0.14260813  8.548304e-01 -3.591477e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [61,] -1.18160708  -0.10113583  8.870059e-01  6.756845e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [62,] -0.98749213  12.41039421  5.245973e+02  1.099792e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [63,] -0.19762544  12.45040253 -5.229169e+02 -2.199780e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [64,]  0.00000000   0.00000000  0.000000e+00  1.098126e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [65,]  0.00000000   0.00000000  0.000000e+00 -7.024458e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [66,] -0.12641647  -7.96423781 -3.344980e+02  1.469705e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [67,] -0.62041814  -7.22939148  3.653615e+02 -7.687523e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [68,] -0.68878219   1.45276382 -7.110111e-01 -2.796661e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [69,] -0.62041412   1.41858907 -7.243285e-01 -9.844306e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [70,] -0.57139992   0.26796281 -4.760197e+01  1.003237e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [71,] -0.59455541  -0.86134132  1.712009e-01  3.470285e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [72,] -0.63537131  -0.85279544  1.877261e-01  7.557291e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [73,] -0.53976211   7.72450097  3.600587e+02 -1.397604e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [74,] -0.01522038   9.02430004 -3.054672e+02  6.403647e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [75,]  0.18341751   1.73861505 -5.316075e-01  5.472878e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [76,]  0.26561582   1.71392091 -5.055462e-01  5.472878e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [77,]  0.10491122 -13.54019505 -6.401673e+02 -1.343290e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [78,] -0.80330481 -14.89514043  5.832596e+02  2.569197e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [79,] -1.07176004  -1.00953265 -6.409093e-02 -1.224980e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [80,] -1.11993704  -1.01455999 -1.470577e-01 -1.742302e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [81,] -1.16157407  -0.59051130  1.795710e+01  3.801874e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [82,] -1.17579757  -0.14260813  8.548304e-01 -3.591477e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [83,] -1.18160708  -0.10113583  8.870059e-01  6.756845e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [84,] -0.98749213  12.41039421  5.245973e+02  1.099792e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [85,] -0.19762544  12.45040253 -5.229169e+02 -2.199780e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [86,]  0.00000000   0.00000000  0.000000e+00  1.098126e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rsupp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1   15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   17   43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   44   65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  400  421</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rani Basna, Xijia Liu, Hiba Nassar, Krzysztof Podgorski, Hanqing Wu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

