<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>B-splines, periodic B-splines and their orthogonalization — splinet • Splinets</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="B-splines, periodic B-splines and their orthogonalization — splinet"><meta name="description" content="The B-splines (periodic B-splines)  are either given in the input or generated inside the routine. Then, given
the B-splines and the argument type, the routine additionally generates a Splinets-object
representing an orthonormal spline basis obtained from a certain
orthonormalization of the B-splines. Orthonormal spline bases are obtained by one of the following methods:
the Gram-Schmidt method, the two-sided method, and/or the splinet algorithm, which is the default method.
All spline bases are kept in the format of Splinets-objects."><meta property="og:description" content="The B-splines (periodic B-splines)  are either given in the input or generated inside the routine. Then, given
the B-splines and the argument type, the routine additionally generates a Splinets-object
representing an orthonormal spline basis obtained from a certain
orthonormalization of the B-splines. Orthonormal spline bases are obtained by one of the following methods:
the Gram-Schmidt method, the two-sided method, and/or the splinet algorithm, which is the default method.
All spline bases are kept in the format of Splinets-objects."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Splinets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FunctionalPrincipalValueDecomposition.html">Functional Principal Value Decomposition</a></li>
    <li><a class="dropdown-item" href="../articles/ImageClassification.html">Image Classification with Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/IntroductiontoSplinets.html">Introduction to Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/MassSpectrometry.html">Splinets Statistical Application: mass spectrometry</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>B-splines, periodic B-splines and their orthogonalization</h1>

      <div class="d-none name"><code>splinet.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The B-splines (periodic B-splines)  are either given in the input or generated inside the routine. Then, given
the B-splines and the argument <code>type</code>, the routine additionally generates a <code>Splinets</code>-object
representing an orthonormal spline basis obtained from a certain
orthonormalization of the B-splines. Orthonormal spline bases are obtained by one of the following methods:
the Gram-Schmidt method, the two-sided method, and/or the splinet algorithm, which is the default method.
All spline bases are kept in the format of <code>Splinets</code>-objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">splinet</span><span class="op">(</span></span>
<span>  knots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  smorder <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"spnt"</span>,</span>
<span>  Bsplines <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  periodic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  norm <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-knots">knots<a class="anchor" aria-label="anchor" href="#arg-knots"></a></dt>
<dd><p><code>n+2</code> vector, the knots (presented in the increasing order); It is not needed, when
<code>Bsplines</code> argumment is not <code>NULL</code>, in which the case the knots from <code>Bsplines</code> are inherited.</p></dd>


<dt id="arg-smorder">smorder<a class="anchor" aria-label="anchor" href="#arg-smorder"></a></dt>
<dd><p>integer,  the order of the splines, the default is <code>smorder=3</code>; Again it is inherited from the
<code>Bsplines</code> argumment if the latter is not <code>NULL</code>.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>string, the type of the basis; The following choices are available</p><ul><li><p><code>'bs'</code> for the unorthogonalized B-splines,</p></li>
<li><p><code>'spnt'</code> for the orthogonal splinet (the default),</p></li>
<li><p><code>'gsob'</code> for the Gramm-Schmidt (one-sided) O-splines,</p></li>
<li><p><code>'twob'</code> for the two-sided O-splines.</p></li>
</ul></dd>


<dt id="arg-bsplines">Bsplines<a class="anchor" aria-label="anchor" href="#arg-bsplines"></a></dt>
<dd><p><code>Splinet</code>-object, the basis of the B-splines (if not <code>NULL</code>);
When this argument is not <code>NULL</code> the first two arguments
are not needed since they will be inherited from <code>Bsplines</code>.</p></dd>


<dt id="arg-periodic">periodic<a class="anchor" aria-label="anchor" href="#arg-periodic"></a></dt>
<dd><p>logical, a flag to indicate if B-splines will be of periodic type or not;</p></dd>


<dt id="arg-norm">norm<a class="anchor" aria-label="anchor" href="#arg-norm"></a></dt>
<dd><p>logical, a flag to indicate if the output B-splines should be normalized;</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Either a list <code>list("bs"=Bsplines)</code> made of a single <code>Splinet</code>-object <code>Bsplines</code>
when <code>type=='bs'</code>, which represents the B-splines (the B-splines are normalized or not, depending
on the <code>norm</code>-flag), or a list of two <code>Splinets</code>-objects: <code>list("bs"=Bsplines,"os"=Splinet)</code>,
where <code>Bsplines</code> are either computed (in the input <code>Bspline= NULL</code>) or taken from the input <code>Bspline</code>
(this output will be normalized or not depending on the <code>norm</code>-flag),
<code>Splinet</code> is the B-spline orthognalization determined by the input argument <code>type</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The B-spline basis, if not given in
the input, is computed
from  the following recurrent (with respect to the smoothness order of the B-splines) formula
$$
B_{l,k}^{\boldsymbol \xi }(x)=
\frac{x- {\xi_{l}}
 }{
{\xi_{l+k}}-{\xi_{l}}
}
B_{l,k-1}^{\boldsymbol \xi}(x)
+
 \frac{{\xi_{l+1+k}}-x }{ {\xi_{l+1+k}}-{\xi_{l+1}}}
 B_{l+1,k-1}^{\boldsymbol \xi}(x), l=0,\dots, n-k.
$$
 The dyadic algorithm that is implemented takes into account efficiencies due to the equally space knots
(exhibited in the Toeplitz form of the Gram matrix) only if the problem is fully dyadic, i.e. if the number of
the internal knots is <code>smorder*2^N-1</code>, for some integer <code>N</code>. To utilize this efficiency it may be advantageous,
for a large number of equally spaced knots, to choose them so that their number follows the fully dyadic form.
An additional advantage of the dyadic form is the complete symmetry at all levels of the support. The algorithm works with
both zero boundary splines and periodic splines.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Liu, X., Nassar, H., Podg\(\mbox{\'o}\)rski, K. "Dyadic diagonalization of positive definite band matrices and efficient B-spline orthogonalization." Journal of Computational and Applied Mathematics (2022) &lt;https://doi.org/10.1016/j.cam.2022.114444&gt;.</p>

<p>Podg\(\mbox{\'o}\)rski, K. (2021)
"<code>Splinets</code> – splines through the Taylor expansion, their support sets and orthogonal bases." &lt;arXiv:2102.00733&gt;.</p>
<p>Nassar, H., Podg\(\mbox{\'o}\)rski, K. (2023) "Splinets 1.5.0 – Periodic Splinets." &lt;arXiv:2302.07552&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="project.html">project</a></code> for projecting into the functional spaces spanned by the spline bases;
<code><a href="lincomb.html">lincomb</a></code> for evaluation of a linear combination of splines;
<code><a href="seq2dyad.html">seq2dyad</a></code> for building the dyadic structure for a splinet of a given smoothness order;
<code><a href="plot-Splinets-method.html">plot,Splinets-method</a></code> for visualisation of splinets;</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#--------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#----Splinet, equally spaced knots-----#</span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">2</span> <span class="co"># order</span></span></span>
<span class="r-in"><span><span class="va">n_knots</span> <span class="op">=</span> <span class="fl">5</span> <span class="co"># number of knots</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n_knots</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span> <span class="co">#Plotting B-splines</span></span></span>
<span class="r-plt img"><img src="splinet-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#Plotting Splinet</span></span></span>
<span class="r-plt img"><img src="splinet-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Verifying the orthogonalization</span></span></span>
<span class="r-in"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#evaluation of the inner products</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.319476e-15</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#An example of the dyadic structure with equally spaced knots</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">N</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">n_knots</span><span class="op">=</span><span class="fl">2</span><span class="op">^</span><span class="va">N</span><span class="op">*</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span> <span class="co">#the number of internal knots for the dyadic case</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n_knots</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span>,type<span class="op">=</span><span class="st">"simple"</span>,vknots<span class="op">=</span><span class="cn">FALSE</span>,lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co">#Plotting B-splines in a single simple plot</span></span></span>
<span class="r-plt img"><img src="splinet-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span>,type<span class="op">=</span><span class="st">"simple"</span>,vknots<span class="op">=</span><span class="cn">FALSE</span>,lwd<span class="op">=</span><span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="splinet-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span>,lwd<span class="op">=</span><span class="fl">3</span>,mrgn<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co">#Plotting the splinet on the dyadic net of support intervals</span></span></span>
<span class="r-plt img"><img src="splinet-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span><span class="op">=</span><span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, Bsplines<span class="op">=</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span>, type<span class="op">=</span><span class="st">'gsob'</span><span class="op">)</span> <span class="co">#Obtaining the Gram-Schmidt orthogonalization</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span>,type<span class="op">=</span><span class="st">"simple"</span>,vknots<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>      <span class="co">#Without computing B-splines again</span></span></span>
<span class="r-plt img"><img src="splinet-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span><span class="op">=</span><span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, Bsplines<span class="op">=</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span>, type<span class="op">=</span><span class="st">'twob'</span><span class="op">)</span> <span class="co">#Obtaining the symmetrize orthogonalization</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span>,type<span class="op">=</span><span class="st">"simple"</span>,vknots<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>     </span></span>
<span class="r-plt img"><img src="splinet-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Splinet, unequally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">n_knots</span><span class="op">=</span><span class="fl">25</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_knots</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sone</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sone</span><span class="op">$</span><span class="va">bs</span>, type<span class="op">=</span><span class="st">'dyadic'</span><span class="op">)</span> <span class="co">#Plotting B-splines</span></span></span>
<span class="r-plt img"><img src="splinet-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sone</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#Plotting Splinet</span></span></span>
<span class="r-plt img"><img src="splinet-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Verifying the orthogonalization</span></span></span>
<span class="r-in"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">sone</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#evaluation of the inner products</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.164443e-13</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Dyadic splinet, equally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">=</span> <span class="fl">2</span> <span class="co"># order</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">=</span> <span class="fl">3</span> <span class="co"># support level</span></span></span>
<span class="r-in"><span><span class="va">n_so</span> <span class="op">=</span> <span class="va">k</span><span class="op">*</span><span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="co"># number of splines in a dyadic structure with N and k</span></span></span>
<span class="r-in"><span><span class="va">n_knots</span> <span class="op">=</span> <span class="va">n_so</span> <span class="op">+</span> <span class="va">k</span> <span class="op">+</span> <span class="fl">1</span> <span class="co"># number of knots</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n_knots</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sodyeq</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sodyeq</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span> <span class="co">#Plotting B-splines</span></span></span>
<span class="r-plt img"><img src="splinet-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sodyeq</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#Plotting Splinet</span></span></span>
<span class="r-plt img"><img src="splinet-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Verifying the orthogonalization</span></span></span>
<span class="r-in"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">sodyeq</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#evaluation of the inner products</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.52321e-14</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Dyadic splinet, unequally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_knots</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sody</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, <span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sody</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span> <span class="co">#Plotting B-splines</span></span></span>
<span class="r-plt img"><img src="splinet-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sody</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#Plotting Splinet</span></span></span>
<span class="r-plt img"><img src="splinet-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Verifying the orthogonalization</span></span></span>
<span class="r-in"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">sody</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#evaluation of the inner products</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.275806e-14</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Bspline basis, equally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">15</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,length.out <span class="op">=</span> <span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">order</span> <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bs</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, <span class="va">order</span>, type <span class="op">=</span> <span class="st">'bs'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">bs</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="splinet-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#---------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Bspline basis, non-equally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#---------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">6</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span>,<span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">order</span> <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, <span class="va">order</span>, type <span class="op">=</span> <span class="st">'bs'</span><span class="op">)</span> <span class="co">#unnormalized version</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="splinet-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so1</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span>type<span class="op">=</span><span class="st">'bs'</span>,Bsplines<span class="op">=</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span>,norm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co">#normalized version</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so1</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="splinet-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Gram-Schmidt osplines, equally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">so</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, <span class="va">order</span>,  type <span class="op">=</span> <span class="st">'gsob'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="splinet-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="splinet-18.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Using the previously generated B-splines and normalizing them</span></span></span>
<span class="r-in"><span><span class="va">so1</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span>Bsplines<span class="op">=</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span>, type <span class="op">=</span> <span class="st">"gsob"</span>,norm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so1</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span> <span class="co">#normalized B-splines</span></span></span>
<span class="r-plt img"><img src="splinet-19.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so1</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#the one sided osplines</span></span></span>
<span class="r-plt img"><img src="splinet-20.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">so1</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#evaluation of the inner products</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1 1 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#verification of the orghonoalization of the matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.520335e-15</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Gram-Schmidt osplines, non-equally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span>Bsplines<span class="op">=</span><span class="va">sody</span><span class="op">$</span><span class="va">bs</span>, type <span class="op">=</span> <span class="st">'gsob'</span><span class="op">)</span> <span class="co">#previously genereted Bsplines</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="splinet-21.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="splinet-22.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.611008e-14</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#---------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Twosided osplines, equally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#---------------------------------------------#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span>Bsplines<span class="op">=</span><span class="va">bs</span><span class="op">$</span><span class="va">bs</span>, type <span class="op">=</span> <span class="st">'twob'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="splinet-23.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#verification of the orthogonality</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.471562e-14</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Twosided osplines, non equally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span>Bsplines<span class="op">=</span><span class="va">sody</span><span class="op">$</span><span class="va">bs</span>, type <span class="op">=</span> <span class="st">'twob'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="splinet-24.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#verification of the orthogonality</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.40572e-14</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Periodic splinet, equally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">2</span> <span class="co"># order</span></span></span>
<span class="r-in"><span><span class="va">n_knots</span> <span class="op">=</span> <span class="fl">12</span> <span class="co"># number of knots</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n_knots</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, <span class="va">k</span>, periodic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span> <span class="co">#Plotting B-splines</span></span></span>
<span class="r-plt img"><img src="splinet-25.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#Plotting Splinet</span></span></span>
<span class="r-plt img"><img src="splinet-26.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Verifying the orthogonalization</span></span></span>
<span class="r-in"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#evaluation of the inner products</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -6.644666e-18</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#An example of the dyadic structure with equally spaced knots</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">N</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">n_knots</span><span class="op">=</span><span class="fl">2</span><span class="op">^</span><span class="va">N</span><span class="op">*</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span> <span class="co">#the number of internal knots for the dyadic case</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n_knots</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, periodic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span>,type<span class="op">=</span><span class="st">"simple"</span><span class="op">)</span> <span class="co">#Plotting B-splines in a single simple plot</span></span></span>
<span class="r-plt img"><img src="splinet-27.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span>,type<span class="op">=</span><span class="st">"simple"</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="splinet-28.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#Plotting the splinet on the dyadic net of support intervals</span></span></span>
<span class="r-plt img"><img src="splinet-29.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span><span class="op">=</span><span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, Bsplines<span class="op">=</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span>, type<span class="op">=</span><span class="st">'gsob'</span><span class="op">)</span> <span class="co">#Obtaining the Gram-Schmidt orthogonalization</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span>,type<span class="op">=</span><span class="st">"simple"</span><span class="op">)</span>      <span class="co">#Without computing B-splines again</span></span></span>
<span class="r-plt img"><img src="splinet-30.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span><span class="op">=</span><span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, Bsplines<span class="op">=</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span> , type<span class="op">=</span><span class="st">'twob'</span><span class="op">)</span> <span class="co">#Obtaining the symmetrize orthogonalization</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span>,type<span class="op">=</span><span class="st">"simple"</span><span class="op">)</span>  </span></span>
<span class="r-plt img"><img src="splinet-31.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Splinet, unequally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">n_knots</span><span class="op">=</span><span class="fl">25</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_knots</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sone</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, <span class="va">k</span>, periodic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sone</span><span class="op">$</span><span class="va">bs</span>, type<span class="op">=</span><span class="st">'dyadic'</span><span class="op">)</span> <span class="co">#Plotting B-splines</span></span></span>
<span class="r-plt img"><img src="splinet-32.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sone</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#Plotting Splinet</span></span></span>
<span class="r-plt img"><img src="splinet-33.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Verifying the orthogonalization</span></span></span>
<span class="r-in"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">sone</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#evaluation of the inner products</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3.920568e-13</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Dyadic splinet, equally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">k</span> <span class="op">=</span> <span class="fl">2</span> <span class="co"># order</span></span></span>
<span class="r-in"><span><span class="va">N</span> <span class="op">=</span> <span class="fl">3</span> <span class="co"># support level</span></span></span>
<span class="r-in"><span><span class="va">n_so</span> <span class="op">=</span> <span class="va">k</span><span class="op">*</span><span class="op">(</span><span class="fl">2</span><span class="op">^</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="co"># number of splines in a dyadic structure with N and k</span></span></span>
<span class="r-in"><span><span class="va">n_knots</span> <span class="op">=</span> <span class="va">n_so</span> <span class="op">+</span> <span class="va">k</span> <span class="op">+</span> <span class="fl">1</span> <span class="co"># number of knots</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n_knots</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sodyeq</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, <span class="va">k</span>, periodic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sodyeq</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span> <span class="co">#Plotting B-splines</span></span></span>
<span class="r-plt img"><img src="splinet-34.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sodyeq</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#Plotting Splinet</span></span></span>
<span class="r-plt img"><img src="splinet-35.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Verifying the orthogonalization</span></span></span>
<span class="r-in"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">sodyeq</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#evaluation of the inner products</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.479494e-14</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Dyadic splinet, unequally spaced knots---#</span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_knots</span><span class="op">)</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sody</span> <span class="op">=</span> <span class="fu">splinet</span><span class="op">(</span><span class="va">xi</span>, <span class="va">k</span>, periodic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sody</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span> <span class="co">#Plotting B-splines</span></span></span>
<span class="r-plt img"><img src="splinet-36.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sody</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#Plotting Splinet</span></span></span>
<span class="r-plt img"><img src="splinet-37.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Verifying the orthogonalization</span></span></span>
<span class="r-in"><span><span class="va">gm</span> <span class="op">=</span> <span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">sody</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#evaluation of the inner products</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">gm</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">gm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.505296e-14</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rani Basna, Xijia Liu, Hiba Nassar, Krzysztof Podgorski, Hanqing Wu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

