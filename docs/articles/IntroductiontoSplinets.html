<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to Splinets • Splinets</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to Splinets">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Splinets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/FunctionalPrincipalValueDecomposition.html">Functional Principal Value Decomposition with the Wine data</a></li>
    <li><a class="dropdown-item" href="../articles/ImageClassification.html">Image Classification with Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/IntroductiontoSplinets.html">Introduction to Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/MassSpectrometry.html">Splinets Statistical Application: mass spectrometry</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ranibasna/R-Splinets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to Splinets</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ranibasna/R-Splinets/blob/HEAD/vignettes/IntroductiontoSplinets.Rmd" class="external-link"><code>vignettes/IntroductiontoSplinets.Rmd</code></a></small>
      <div class="d-none name"><code>IntroductiontoSplinets.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ranibasna/R-Splinets" class="external-link">Splinets</a></span><span class="op">)</span></span></code></pre></div>
<p>This is a reproducible example of the introduction section of the
paper Splinets - Orthogonal Splines for Functional Data Analysis}</p>
<div class="section level2">
<h2 id="introduction-to-splinets">Introduction to Splinets<a class="anchor" aria-label="anchor" href="#introduction-to-splinets"></a>
</h2>
<p>Examples of splines for non-equally spaced knots (first two figures)
and equally spaced knots (right). Both individual splines and random
spline samples generated around with a use of the implemented random
spline generator. Vertical dashed lines in all figures are placed at the
locations of the knots.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span><span class="op">=</span><span class="fl">20</span>; <span class="va">k</span><span class="op">=</span><span class="fl">3</span> <span class="co">#Number of knots and the order of splines</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span>; <span class="va">xi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>; <span class="va">xi</span><span class="op">[</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span> <span class="co">#Randomly distributed knots</span></span>
<span></span>
<span><span class="va">S</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co">#Random matrix of derivatives</span></span>
<span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="../reference/construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">S</span><span class="op">)</span> <span class="co">#A spline object with corrected matrix of the derivatives</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using  method RRM to correct the derivative matrix entries.</span></span>
<span><span class="co">#&gt; NOTE: Knots are not in the strictly increasing order, which is required.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         The knots have been ordered and ties have been removed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; DIAGNOSTIC CHECK of a SPLINETS object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; THE KNOTS:  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; THE SUPPORT SETS:  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The support sets for the splines are equal to the entire range of knots.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; THE DERIVATIVES AT THE KNOTS:  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span></span>
<span><span class="co">#&gt; Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Spline 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span></span>
<span><span class="co">#&gt; The spline 1 'ths highest derivative at the two central knots has been made equal by averaging SLOT 'der'.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The derivative matrix for spline 1 does not satisfy the smoothness conditions (up to the accuracy SLOT 'epsilon').</span></span>
<span><span class="co">#&gt; The standard error per matrix entry is 1.317087 .</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correction of the LHS part of the matrix</span></span>
<span><span class="co">#&gt; Correction of the RHS part of the matrix</span></span>
<span><span class="co">#&gt; Correction of the LHS part of the matrix</span></span>
<span><span class="co">#&gt; There are less than 5 knots, the first 1 entries of the 5 nd row counting from the end in the input will be changed in the output.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correction of the RHS part of the matrix</span></span>
<span><span class="co">#&gt; There are less than 5 knots, the first 1 entries of the 5 nd row counting from the end in the input will be changed in the output.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correction of the LHS part of the matrix</span></span>
<span><span class="co">#&gt; Correction of the RHS part of the matrix</span></span>
<span><span class="co">#&gt; The output object has the derivative matrix corrected by the RRM method.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The matrix derivative is now corrected by method RRM .</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductiontoSplinets_files/figure-html/unnamed-chunk-2-1.png" width="768"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span><span class="op">=</span><span class="fu"><a href="../reference/rspline.html">rspline</a></span><span class="op">(</span><span class="va">spl</span>,<span class="fl">10</span><span class="op">)</span> <span class="co">#Random spline generator</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductiontoSplinets_files/figure-html/unnamed-chunk-3-1.png" width="768"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xi2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">spl2</span><span class="op">=</span><span class="fu"><a href="../reference/construct.html">construct</a></span><span class="op">(</span><span class="va">xi2</span>,<span class="va">k</span>,<span class="va">S</span><span class="op">)</span> <span class="co">#Another spline object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Using  method RRM to correct the derivative matrix entries.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; DIAGNOSTIC CHECK of a SPLINETS object</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; THE KNOTS:  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; THE SUPPORT SETS:  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The support sets for the splines are equal to the entire range of knots.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; THE DERIVATIVES AT THE KNOTS:  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span></span>
<span><span class="co">#&gt; Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Spline 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span></span>
<span><span class="co">#&gt; Spline 1 's highest derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The matrix of derivatives at the knots for spline 1 does not satisfy the conditions </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           required for a spline (up to the accuracy SLOT 'epsilon').</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;           One of the reasons can be that SLOT 'taylor' is not correctly given.</span></span>
<span><span class="co">#&gt; The computed standard error per matrix entry is 1.326947 .</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Correction of the LHS part of the matrix</span></span>
<span><span class="co">#&gt; Correction of the RHS part of the matrix</span></span>
<span><span class="co">#&gt; Correction of the LHS part of the matrix</span></span>
<span><span class="co">#&gt; Correction of the RHS part of the matrix</span></span>
<span><span class="co">#&gt; Correction of the LHS part of the matrix</span></span>
<span><span class="co">#&gt; Correction of the RHS part of the matrix</span></span>
<span><span class="co">#&gt; The output object Spline 1  has the derivative matrix corrected by the RRM method</span></span>
<span><span class="co">#&gt;  given that SLOT 'taylor' is properly given.</span></span>
<span><span class="co">#&gt; The matrix derivative is now corrected by method RRM .</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spl2</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductiontoSplinets_files/figure-html/unnamed-chunk-4-1.png" width="768"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y2</span><span class="op">=</span><span class="fu"><a href="../reference/rspline.html">rspline</a></span><span class="op">(</span><span class="va">spl2</span>,<span class="fl">10</span><span class="op">)</span> <span class="co">#Another random sample</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y2</span><span class="op">)</span></span></code></pre></div>
<p><img src="IntroductiontoSplinets_files/figure-html/unnamed-chunk-5-1.png" width="768"></p>
<p>The result is shown in above demonstrate that the knot distribution
is fundamental in shaping geometry of functional spaces. The difference
in the nature of the two linear functional spaces observed is obvious,
as in the first twographs we see more capacity to focus on the localized
variability and detail, the capacity that is lacked in splines in the
right-hand side graphs.</p>
</div>
<div class="section level2">
<h2 id="orthonormal-bases-of-splines">Orthonormal bases of splines<a class="anchor" aria-label="anchor" href="#orthonormal-bases-of-splines"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">k</span><span class="op">=</span><span class="fl">3</span>; <span class="va">N</span><span class="op">=</span><span class="fl">5</span> <span class="co">#Order of splines and the number of layers</span></span>
<span><span class="va">n</span><span class="op">=</span><span class="va">k</span><span class="op">*</span><span class="fl">2</span><span class="op">^</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span> <span class="co">#Number of knots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span>,min<span class="op">=</span><span class="fl">0.2</span><span class="op">)</span><span class="op">)</span> <span class="co">#Random knots</span></span>
<span><span class="va">so</span> <span class="op">=</span> <span class="fu"><a href="../reference/splinet.html">splinet</a></span><span class="op">(</span><span class="va">xi</span>, <span class="va">k</span><span class="op">)</span> <span class="co">#Evaluation of the B-splines and the splinet</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span>,type<span class="op">=</span><span class="st">'dyadic'</span><span class="op">)</span> <span class="co">#B-splines on the dyadic net</span></span></code></pre></div>
<p><img src="IntroductiontoSplinets_files/figure-html/unnamed-chunk-6-1.png" width="768"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#Splinet on the dyadic net</span></span></code></pre></div>
<p><img src="IntroductiontoSplinets_files/figure-html/unnamed-chunk-6-2.png" width="768"></p>
<p>Cubic spline bases presented graphically in the sequential form (top)
and on the dyadic net (bottom). The case of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mi>k</mi><msup><mn>2</mn><mi>N</mi></msup><mo>−</mo><mn>1</mn><mo>=</mo><mn>95</mn></mrow><annotation encoding="application/x-tex">n=k2^N-1=95</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>3</mn></mrow><annotation encoding="application/x-tex">k=3</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">N=5</annotation></semantics></math>
which is the number of layers in the dyadic structure seen in the
figures. The first is the B-spline basis; After is the corresponding
splinet.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rani Basna, Xijia Liu, Hiba Nassar, Krzysztof Podgorski, Hanqing Wu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
