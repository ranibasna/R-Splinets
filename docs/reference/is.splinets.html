<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Diagnostics of splines and their generic correction — is.splinets • Splinets</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Diagnostics of splines and their generic correction — is.splinets"><meta name="description" content="The method performs verification of the properties of SLOTS of an object belonging to the
Splinets–class. In the case when all the properties are satisfied the logical TRUE is returned. Otherwise,
FALSE is returned together with suggested corrections."><meta property="og:description" content="The method performs verification of the properties of SLOTS of an object belonging to the
Splinets–class. In the case when all the properties are satisfied the logical TRUE is returned. Otherwise,
FALSE is returned together with suggested corrections."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Splinets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FunctionalPrincipalValueDecomposition.html">Functional Principal Value Decomposition</a></li>
    <li><a class="dropdown-item" href="../articles/ImageClassification.html">Image Classification with Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/IntroductiontoSplinets.html">Introduction to Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/MassSpectrometry.html">Splinets Statistical Application: mass spectrometry</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Diagnostics of splines and their generic correction</h1>

      <div class="d-none name"><code>is.splinets.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The method performs verification of the properties of SLOTS of an object belonging to the
<code>Splinets</code>–class. In the case when all the properties are satisfied the logical <code>TRUE</code> is returned. Otherwise,
<code>FALSE</code> is returned together with suggested corrections.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><code>Splinets</code> object, the object to be diagnosed; For this object to be corrected properly each support interval has to have at least <code>2*smorder+4</code> knots.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list made of: a logical value <code>is</code>, a <code>Splinets</code> object <code>robject</code>, and a numeric value <code>Er</code>.</p><ul><li><p>The logical value <code>is</code> indicates if all the condtions for the elements of <code>Splinets</code> object to be a collection of valid
splines are satisfied, additional diagnostic messages are printed out.</p></li>
<li><p>The object <code>robject</code> is a modified input object that has all SLOT fields modified so the conditions/restrictions
to be a proper spline are satisfied.</p></li>
<li><p>The numeric value <code>Er</code> is giving the total squared error of deviation of the input matrix of derivative from the conditions required for a spline.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Liu, X., Nassar, H., Podg\(\mbox{\'o}\)rski, K. "Dyadic diagonalization of positive definite band matrices and efficient B-spline orthogonalization." Journal of Computational and Applied Mathematics (2022) &lt;https://doi.org/10.1016/j.cam.2022.114444&gt;.</p>

<p>Podg\(\mbox{\'o}\)rski, K. (2021)
"<code>Splinets</code> – splines through the Taylor expansion, their support sets and orthogonal bases." &lt;arXiv:2102.00733&gt;.</p>
<p>Nassar, H., Podg\(\mbox{\'o}\)rski, K. (2023) "Splinets 1.5.0 – Periodic Splinets." &lt;arXiv:2302.07552&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="Splinets-class.html">Splinets-class</a></code> for the definition of the <code>Splinets</code>-class;
<code><a href="construct.html">construct</a></code> for constructing such an object from the class;
<code><a href="gather.html">gather</a></code> and <code><a href="subsample.html">subsample</a></code>  for combining and subsampling <code>Splinets</code>-objects, respectively;
<code><a href="plot-Splinets-method.html">plot,Splinets-method</a></code> for plotting <code>Splinets</code> objects;</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#--------Diagnostics of simple Splinets objects-------#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#----------Full support equidistant cases-------------#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#Zero order splines, equidistant case, full support</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">20</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"Splinets"</span>,knots<span class="op">=</span><span class="va">xi</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">equid</span> <span class="co">#equidistance flag</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="co">#Diagnostic of 'Splinets' object 'sp'</span></span></span>
<span class="r-in"><span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The full support range case.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SLOT 'der' do not have properly set the dimension for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In the output object, it is set temporarily to the matrix of 'ones' with the proper dimension.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 22 equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: The full support range for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">IS</span><span class="op">=</span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The full support range case.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SLOT 'der' do not have properly set the dimension for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In the output object, it is set temporarily to the matrix of 'ones' with the proper dimension.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">IS</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co">#informs if the object is a spline</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span><span class="va">IS</span><span class="op">$</span><span class="va">is</span>   <span class="co">#equivalent to the above</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Third order splines with a noisy matrix of the derivative</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">3</span>; <span class="va">sp</span><span class="op">@</span><span class="va">smorder</span><span class="op">=</span><span class="va">k</span>; <span class="va">sp</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">IS</span><span class="op">=</span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The Taylor expansion coefficient matrix does not have the proper number of columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> It is evaluated now and assigned to the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 does not satisfy the conditions </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           One of the reasons can be that SLOT 'taylor' is not correctly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.303131 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  has the derivative matrix corrected by the RRM method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  given that SLOT 'taylor' is properly given.</span>
<span class="r-in"><span><span class="va">IS</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">taylor</span> <span class="co">#corrections</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]       [,2]        [,3]         [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1 0.04761905 0.001133787 1.799662e-05</span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">taylor</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1</span>
<span class="r-in"><span><span class="va">IS</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">der</span> <span class="co">#corrections</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]        [,2]          [,3]          [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.00000000   0.0000000    0.00000000 -7.024458e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -0.12641647  -7.9642378 -334.49798786  1.469705e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -0.62041814  -7.2293915  365.36153367 -7.687523e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -0.68878219   1.4527638   -0.71101105 -2.796661e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.62041412   1.4185891   -0.72432849 -9.844306e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.57139992   0.2679628  -47.60197450  1.003237e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -0.59455541  -0.8613413    0.17120093  3.470285e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -0.63537131  -0.8527954    0.18772610  7.557291e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -0.53976211   7.7245010  360.05872310 -1.397604e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.01522038   9.0243000 -305.46716206  6.403647e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  0.18341751   1.7386151   -0.53160753  5.472878e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  0.26561582   1.7139209   -0.50554621  5.472878e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  0.10491122 -13.5401950 -640.16732427 -1.343290e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] -0.80330481 -14.8951404  583.25961806  2.569197e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] -1.07176004  -1.0095326   -0.06409093 -1.224980e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] -1.11993704  -1.0145600   -0.14705771 -1.742302e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] -1.16157407  -0.5905113   17.95710289  3.801874e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] -1.17579757  -0.1426081    0.85483042 -3.591477e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] -1.18160708  -0.1011358    0.88700587  6.756845e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] -0.98749213  12.4103942  524.59725595  1.099792e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] -0.19762544  12.4504025 -522.91690639 -2.199780e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]  0.00000000   0.0000000    0.00000000  1.098126e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">der</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]        [,2]        [,3]        [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] -0.84085548  1.46796190 -0.45656894 -2.10232912</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  1.38435934  0.70676109  0.56222336 -0.30170228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -1.25549186  0.81900893 -0.88700851 -1.27238344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.07014277 -0.29348185 -0.46024458 -0.27966611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  1.71144087  1.41858907 -0.72432849 -0.20409732</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.60290798  1.49877383 -0.06921116 -0.22561419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -0.47216639 -0.65708209  1.46324856  0.34702845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -0.63537131 -0.85279544  0.18772610  0.03236784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -0.28577363  0.31591504  1.02202286  0.41353129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  0.13810822  1.10969417 -0.59183483 -0.15534848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  1.22763034  2.21546057 -0.11220066  0.97348539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] -0.80177945  1.21710364 -0.92495309  0.12109014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] -1.08039260  1.47922179  0.75330480  0.18917369</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] -0.15753436  0.95157383 -0.11260907 -0.56288507</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] -1.07176004 -1.00953265 -0.06409093  0.49841617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] -0.13898614 -2.00047274  0.23327529 -1.74230249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] -0.59731309 -1.76218587 -1.13658280  0.97552910</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] -2.18396676 -0.14260813  0.85483042 -0.02408287</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]  0.24081726  1.55006037 -0.57837042  0.67568448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] -0.25935541 -0.80242318  0.49636154 -0.71030961</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]  0.90051195 -0.07457892 -0.76005793  2.38723265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]  0.94186939  1.89566795 -0.34138627 -0.47343201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">IS</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#The output object is a valid splinet</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 22 equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: The full support range for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.237243e-23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#--------Full support non-equidistant cases-----------#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#Zero order splines, non-equidistant case, full support</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">17</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span> ;<span class="va">xi</span><span class="op">[</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span> <span class="co">#The last knot is not in the order.</span></span></span>
<span class="r-in"><span>          <span class="co">#It will be reported and corrected in the output.  </span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"Splinets"</span>,knots<span class="op">=</span><span class="va">xi</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NOTE: Knots are not in the strictly increasing order, which is required.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         The knots have been ordered and ties have been removed.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="co">#original knots</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.0000000 0.1104530 0.2002145 0.2018752 0.2625931 0.2732849 0.2843995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 0.3184040 0.3875257 0.4905132 0.5279600 0.5549226 0.5591728 0.6852186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 0.7010575 0.8079352 0.8878698 1.0000000 0.9565001</span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">knots</span> <span class="co">#vs. corrected ones</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.0000000 0.1104530 0.2002145 0.2018752 0.2625931 0.2732849 0.2843995</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 0.3184040 0.3875257 0.4905132 0.5279600 0.5549226 0.5591728 0.6852186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15] 0.7010575 0.8079352 0.8878698 0.9565001 1.0000000</span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">taylor</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Diagnostic of 'Splinets' object 'sp'</span></span></span>
<span class="r-in"><span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The full support range case.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SLOT 'der' do not have properly set the dimension for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In the output object, it is set temporarily to the matrix of 'ones' with the proper dimension.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 19 non-equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: The full support range for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">IS</span><span class="op">=</span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The full support range case.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SLOT 'der' do not have properly set the dimension for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In the output object, it is set temporarily to the matrix of 'ones' with the proper dimension.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="va">nsp</span><span class="op">=</span><span class="va">IS</span><span class="op">$</span><span class="va">robject</span> <span class="co">#the output spline -- a corrected version of the input</span></span></span>
<span class="r-in"><span><span class="va">nsp</span><span class="op">@</span><span class="va">der</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">der</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Third order splines</span></span></span>
<span class="r-in"><span><span class="va">nsp</span><span class="op">@</span><span class="va">smorder</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">IS</span><span class="op">=</span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">nsp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The Taylor expansion coefficient matrix does not have the proper number of columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> It is evaluated now and assigned to the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The full support range case.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SLOT 'der' do not have properly set the dimension for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In the output object, it is set temporarily to the matrix of 'ones' with the proper dimension.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  The spline 1 'ths highest derivative at the central knot is zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Now it is set to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The derivative matrix for spline 1 does not satisfy the smoothness conditions (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The standard error per matrix entry is 0.3450153 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object has the derivative matrix corrected by the RRM method.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">IS</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">taylor</span> <span class="co">#corrections</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]        [,2]         [,3]         [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1 0.110453019 6.099935e-03 2.245854e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    1 0.089761434 4.028558e-03 1.205364e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    1 0.001660759 1.379060e-06 7.634284e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    1 0.060717928 1.843333e-03 3.730779e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    1 0.010691811 5.715741e-05 2.037054e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    1 0.011114508 6.176614e-05 2.288334e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    1 0.034004561 5.781551e-04 6.553303e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    1 0.069121728 2.388907e-03 5.504179e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    1 0.102987455 5.303208e-03 1.820546e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    1 0.037446782 7.011308e-04 8.751697e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    1 0.026962570 3.634901e-04 3.266876e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    1 0.004250273 9.032409e-06 1.279673e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    1 0.126045769 7.943768e-03 3.337594e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    1 0.015838864 1.254348e-04 6.622482e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    1 0.106877742 5.711426e-03 2.034748e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    1 0.079934571 3.194768e-03 8.512413e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    1 0.068630354 2.355063e-03 5.387626e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    1 0.043499875 9.461196e-04 1.371869e-05</span>
<span class="r-in"><span><span class="va">nsp</span><span class="op">@</span><span class="va">taylor</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    1</span>
<span class="r-in"><span><span class="va">IS</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">der</span> <span class="co">#corrections</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]         [,3]        [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.0000000  0.0000000    0.0000000   1212.5612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.2723235  7.3965443  133.9310482  -4532.9778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.9294082  1.1570255 -272.9555385 164915.0719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.9310792  0.9311399    0.9285903      1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.9893651  0.9893653    0.9893082      1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 1.0000000  1.0000000    1.0000000 -21636.2875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 1.0062252 -0.3252755 -239.4766832  10047.1028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.9225514 -2.6597914  102.1706392  -1465.1489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.9021337  0.9023158    0.8970125      1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 1.0000000  1.0000000    1.0000000      0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 1.0381567  1.0381479    1.0374468      1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 1.0373264 -2.1826600 -239.9470100  -8937.7407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 1.0267724 -2.5741835   55.7124704  69562.4740</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 1.0000000  1.0000000    1.0000000   -434.0683</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 1.0159650  1.0159643    1.0158389      1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 1.1305543  1.1302463    1.1227166      1.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 0.9335090 -9.7006120 -272.1158102  -3418.2773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 0.1070929 -7.3857362  339.5750532   8912.8328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 0.0000000  0.0000000    0.0000000  -7806.3455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">nsp</span><span class="op">@</span><span class="va">der</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">IS</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#verification that the correction is a valid object</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 19 non-equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: The full support range for each spline.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.382228e-23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Randomly assigning the derivative -- a very 'unstable' function.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="va">nsp</span><span class="op">@</span><span class="va">smorder</span>; <span class="va">S</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>; <span class="va">nsp</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">=</span><span class="va">S</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">IS</span><span class="op">=</span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">nsp</span><span class="op">)</span> <span class="co">#the 2nd element of 'IS' is a spline obtained by correcting 'S'</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The Taylor expansion coefficient matrix does not have the proper number of columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> It is evaluated now and assigned to the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  The spline 1 'ths highest derivative at the central knot is zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Now it is set to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The derivative matrix for spline 1 does not satisfy the smoothness conditions (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The standard error per matrix entry is 1.286421 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object has the derivative matrix corrected by the RRM method.</span>
<span class="r-in"><span><span class="va">nsp</span><span class="op">=</span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">IS</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">nsp</span><span class="op">$</span><span class="va">is</span> <span class="co">#The 'Splinets' object is correct, alternatively use 'nsp$[[1]]'.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="va">nsp</span><span class="op">$</span><span class="va">robject</span> <span class="co">#A correct spline object, alternatively use 'nsp$[[2]]'.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 19 non-equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: The full support range for each spline.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#-----Splinets objects with varying support sets------#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------Eequidistant cases------------------#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#Zero order splines, equidistant case, support with three components</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">20</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">support</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">8</span>,<span class="fl">12</span>,<span class="fl">18</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"Splinets"</span>,knots<span class="op">=</span><span class="va">xi</span>,supp<span class="op">=</span><span class="va">support</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The partial support range case.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SLOT 'der' do not have properly set the dimension for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In the output object, it is set temporarily to the matrix of 'ones' with the proper dimension.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 22 equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: Not the full range support, the number of support intervals varies from 3 to 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">IS</span><span class="op">=</span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The partial support range case.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SLOT 'der' do not have properly set the dimension for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In the output object, it is set temporarily to the matrix of 'ones' with the proper dimension.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co">#the number of knots in the support</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 14</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">IS</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>  <span class="co">#the number of rows in the derivative matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 14</span>
<span class="r-in"><span><span class="va">IS</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">der</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="co">#the corrected object</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    1</span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">der</span> <span class="co">#the input derivative matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Third order splines</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">40</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>; <span class="va">k</span><span class="op">=</span><span class="fl">3</span>; </span></span>
<span class="r-in"><span><span class="va">support</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">15</span>,<span class="fl">27</span>,<span class="fl">30</span>,<span class="fl">40</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">support</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">support</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co">#the number of knots in the support</span></span></span>
<span class="r-in"><span><span class="va">SS</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#the derivative matrix at random</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"Splinets"</span>,knots<span class="op">=</span><span class="va">xi</span>,smorder<span class="op">=</span><span class="va">k</span>,supp<span class="op">=</span><span class="va">support</span>,der<span class="op">=</span><span class="va">SS</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">IS</span><span class="op">=</span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 2 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 3 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 1 's highest derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 1 's highest derivative value at the central knot has been made equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.55822 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 2 's highest derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 2 's highest derivative value at the central knot has been made equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 2  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.697993 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 2 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 3 's highest derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 3 's highest derivative value at the central knot has been made equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 3  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.360743 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 3 has the derivative matrix corrected by the RRM method.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co">#the number of knots in the support</span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">der</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#the derivative matrix at random</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">IS</span><span class="op">=</span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">sp</span><span class="op">)</span> <span class="co">#Comparison of the corrected and the original 'der' matrices</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 2 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 3 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 1 's highest derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 1 's highest derivative value at the central knot has been made equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.221246 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 2 's highest derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 2 's highest derivative value at the central knot has been made equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 2  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.457675 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 2 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 3 's highest derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 3 's highest derivative value at the central knot has been made equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 3  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.275708 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 3 has the derivative matrix corrected by the RRM method.</span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">der</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]         [,2]        [,3]         [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] -0.14264393 -0.266899439  1.39995727  1.374653325</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  1.41878305  0.164155956  0.01701396  0.291895737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.48713390 -0.393458947  1.84749695  0.710591710</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.60344145 -1.843737246 -0.68633938 -0.937760920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.21083288 -1.542288267 -0.21872403 -1.114063127</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.03329921 -0.586240360  0.68259291  0.634371955</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  2.02519699 -0.852138909  0.52413002 -0.231192902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -0.37078675  0.778324555  0.08054998 -1.368194204</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -1.57823445 -0.030317074  0.05378554 -0.754907446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.12157195 -1.455657582 -0.73725899 -1.125596649</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] -1.79667682  0.093784923  0.96643806 -0.219359247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] -0.47559154  0.982349222  0.98430685 -0.134307952</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] -0.88410232 -0.596710162  0.18729094 -0.818020611</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] -3.49805898  0.074804851  0.27298575  0.472334157</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] -0.38198337  2.197429431  1.21014609 -0.869256130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]  0.97768813  0.795023212  0.18865716 -1.332288341</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] -0.55804095 -0.538942212  1.96249867  0.070562870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] -0.62645515 -1.601283178  0.13871194  0.464093186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] -0.53045123 -0.731373566 -1.57862735  0.289158499</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]  1.89762159 -0.355740791 -0.79702127 -2.884941083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]  1.39554068 -0.985414318  1.22435388 -2.334691775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] -0.74602587 -0.731170643 -0.36533356 -1.730891047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] -0.30557308  1.465324083 -0.16259028  0.825009586</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]  1.16967817  1.858615318  0.56047918 -1.045039551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]  0.30438718  0.003497027 -0.86072563 -0.877193374</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,] -0.11749825 -1.343775245  1.23863449 -0.400389842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,] -0.06008553  0.151294033  0.76743575 -1.268188972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]  1.47093895  0.290009125 -1.08740911  0.138586391</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,] -1.47814761 -0.122478328  0.06750377  1.183571604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,] -0.68361295  0.125154388  1.60514057 -2.110555073</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31,]  0.46054060 -0.772434114  1.23222943  0.260676110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32,] -0.18150193 -1.012966123 -0.37911379  0.945566826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33,] -1.15881631  0.966919601 -1.34986658 -0.619960620</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34,]  0.40901892 -0.423327300  0.36491810 -0.009100739</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35,] -0.25820706 -0.831599455 -0.36359492  0.520225423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">IS</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">der</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]         [,2]          [,3]          [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.000000000   0.00000000     0.0000000  7.869495e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.001903023   0.23407184    19.1938908 -2.632501e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.006955176  -0.08080077   -45.0134446  1.875589e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -0.003868862  -0.62081061     0.7326374 -9.377609e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.018794935  -0.60322034     0.7097652 -1.114063e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.033299206  -0.58624036     0.6825929  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -0.047395278  -0.56966052     0.6769541 -2.311929e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -0.061091392  -0.55355640     0.6435835 -1.368194e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -0.059835966   1.25368162   147.5499346  6.023160e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.012410858   1.52653553  -125.1759138 -1.118176e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  0.000000000   0.00000000     0.0000000  5.132212e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  0.000000000   0.00000000     0.0000000 -3.235754e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] -0.078247889  -9.62449036  -789.2082095  6.199852e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] -0.397808697 -10.43250832   722.9507366 -2.963238e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] -0.508882038  -1.61347667     0.2098585 -8.692561e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] -0.548174809  -1.60861673     0.1886572 -2.118317e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] -0.587358371  -1.60464541     0.1369909  7.056287e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] -0.626455147  -1.60128318     0.1387119  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] -0.665468876  -1.59781395     0.1457646  2.891585e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] -0.704490066  -1.60575611    -0.7970213 -3.865422e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] -0.743897563  -1.62589009    -0.8539650 -2.334692e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] -0.646450652  15.24816433  1384.5264272  5.680060e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] -0.130620459  16.06631648 -1317.4379512 -1.107805e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]  0.000000000   0.00000000     0.0000000  5.401496e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]  0.000000000   0.00000000     0.0000000 -4.746495e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,] -0.114781056 -14.11806983 -1157.6817258  9.497826e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,] -0.573788324 -14.10368454  1158.8613197 -4.744883e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,] -0.687828663   0.04795220     1.5728928  1.385864e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,] -0.686190918   0.08635666     1.5762730  1.183572e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,] -0.683612946   0.12515439     1.6051406  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31,] -0.680082333   0.16438169     1.6114985  2.606761e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32,] -0.675591410   0.20396779     1.6345611  9.455668e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33,] -0.559487219  13.85294618  1117.5816671  4.575383e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34,] -0.111715410  13.74099545 -1126.7616269 -9.201808e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35,]  0.000000000   0.00000000     0.0000000  4.619723e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">IS</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co">#verification</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $is</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $robject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> splines</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots: 42 equaly distributed knots between 0 and 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Size: 1 spline functions</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Order: 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Support: Not the full range support, the number of support intervals varies from 3 to 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $Er</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5.729312e-22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#----------------Non-equidistant cases----------------#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#Zero order splines, non-equidistant case, support with three components</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">43</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>; <span class="va">k</span><span class="op">=</span><span class="fl">3</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>; <span class="va">xi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>; <span class="va">xi</span><span class="op">[</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span>;</span></span>
<span class="r-in"><span><span class="va">support</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">14</span>,<span class="fl">17</span>,<span class="fl">30</span>,<span class="fl">32</span>,<span class="fl">43</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ssp</span><span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"Splinets"</span>,knots<span class="op">=</span><span class="va">xi</span>,supp<span class="op">=</span><span class="va">support</span><span class="op">)</span> <span class="co">#with partial support</span></span></span>
<span class="r-in"><span><span class="va">nssp</span><span class="op">=</span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">ssp</span><span class="op">)</span><span class="op">$</span><span class="va">robject</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The partial support range case.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SLOT 'der' do not have properly set the dimension for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> In the output object, it is set temporarily to the matrix of 'ones' with the proper dimension.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">nssp</span><span class="op">@</span><span class="va">supp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    2   14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   17   30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]   32   43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">nssp</span><span class="op">@</span><span class="va">der</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [38,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39,]    1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Third order splines</span></span></span>
<span class="r-in"><span><span class="va">nssp</span><span class="op">@</span><span class="va">smorder</span><span class="op">=</span><span class="fl">3</span> <span class="co">#changing the order of the 'Splinets' object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">nssp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">nssp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co">#the number of knots in the support</span></span></span>
<span class="r-in"><span><span class="va">nssp</span><span class="op">@</span><span class="va">der</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co">#the derivative matrix at random</span></span></span>
<span class="r-in"><span><span class="va">IS</span><span class="op">=</span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">nssp</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The Taylor expansion coefficient matrix does not have the proper number of columns.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> It is evaluated now and assigned to the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 2 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 3 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 1 's highest derivative at the central knot is not zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Now it is set to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the splie conditions (up to the accuracy set in SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.627611 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 2 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 2 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 2  - highest derivative is not symmetric at the center (equal values at the two central knots).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The two values have been made equal by averaging.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 2  does not satisfy the splie conditions (up to the accuracy set in SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.150335 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 1 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 1 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 2 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 3  - highest derivative is not symmetric at the center (equal values at the two central knots).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The two values have been made equal by averaging.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 3  does not satisfy the splie conditions (up to the accuracy set in SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.441687 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 2 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 2 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 3 has the derivative matrix corrected by the RRM method.</span>
<span class="r-in"><span><span class="va">IS</span><span class="op">$</span><span class="va">robject</span><span class="op">@</span><span class="va">der</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]         [,2]          [,3]          [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.00000000   0.00000000     0.0000000 -1.929628e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -0.07223144  -7.68032463  -544.4294521  2.973828e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -0.51799311  -1.84007207   802.3475387 -1.381047e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -0.51965960   0.49062561     0.9409529  1.170856e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -0.50475579   0.51892312     0.9755291 -1.155369e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -0.50375248   0.52059087     0.7525181 -1.317889e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -0.47216639   0.56222336     0.6756845  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -0.47123174   0.56334697     0.6774436  1.059250e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -0.46584375   0.57785065     2.3872326  1.806421e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -0.45728946   0.61213059     2.3814814 -4.000335e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] -0.42897644   7.72288244  1497.5455686  1.576934e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] -0.02824895   7.92633217 -1482.6921789 -1.087901e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  0.00000000   0.00000000     0.0000000  1.386755e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]  0.00000000   0.00000000     0.0000000  3.805467e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]  0.20945973   9.09090662   263.0404888 -2.309831e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]  0.27442205   1.53955269 -1886.1760195  2.219179e+06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]  0.27527652   0.73798142     0.3877417 -1.040391e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]  0.30490246   0.75330480     0.3836081 -4.316087e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]  0.31014395   0.64052034   -31.2045231  8.766823e+02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]  0.31972965   0.08524925    -0.3599475 -3.928057e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]  0.32033865   0.08262743    -0.3627974 -3.928057e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]  0.32068766   0.14844113    39.7230232  1.198677e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]  0.34434732   0.85483042    -1.9953870 -1.114072e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [24,]  0.34903214   0.84381186    -1.9997776 -7.959950e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [25,]  0.25682571 -14.56421432 -1434.8722730 -6.681110e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [26,]  0.18892004 -15.75261450   875.6610039  5.436200e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [27,]  0.00000000   0.00000000     0.0000000 -2.433825e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [28,]  0.00000000   0.00000000     0.0000000  1.490336e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [29,]  0.09869725  18.69400222  2360.5231706 -1.600882e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [30,]  0.71909846  34.17654465  -784.1713346  9.003958e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [31,]  1.71295715   0.02917131     1.2820225 -2.298096e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [32,]  1.71323710   0.03960047     1.2801516 -8.778185e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [33,]  1.71372073   0.04830473     0.3326189  2.767448e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [34,]  1.71449938   0.05342927     0.3368556  2.767448e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [35,]  1.71807967   0.12052555     2.6001420  4.953529e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [36,]  1.71836848   0.12660156     2.5989327 -5.173768e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [37,]  1.23335970 -54.84726795 -4125.3309911 -1.547858e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [38,]  0.47286188 -54.48517894  4185.3443903  6.887145e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [39,]  0.00000000   0.00000000     0.0000000 -1.607511e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu">is.splinets</span><span class="op">(</span><span class="va">IS</span><span class="op">$</span><span class="va">robject</span><span class="op">)</span><span class="op">$</span><span class="va">is</span> <span class="co">#verification of the corrected output object</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rani Basna, Xijia Liu, Hiba Nassar, Krzysztof Podgorski, Hanqing Wu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

