<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Projecting into spline spaces — project • Splinets</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Projecting into spline spaces — project"><meta name="description" content="The projection of splines or functional data into the linear spline space spanned over a given set of knots."><meta property="og:description" content="The projection of splines or functional data into the linear spline space spanned over a given set of knots."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Splinets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ImageClassification.html">Image Classification with Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/MassSpectrometry.html">Splinets Statistical Application: mass spectrometry</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Projecting into spline spaces</h1>

      <div class="d-none name"><code>project.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The projection of splines or functional data into the linear spline space spanned over a given set of knots.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">project</span><span class="op">(</span></span>
<span>  <span class="va">fdsp</span>,</span>
<span>  knots <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  smorder <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  periodic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  basis <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"spnt"</span>,</span>
<span>  graph <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-fdsp">fdsp<a class="anchor" aria-label="anchor" href="#arg-fdsp"></a></dt>
<dd><p><code>Splinets</code>-object or a <code>n x (N+1)</code> matrix, a representation of <code>N</code> functions to be projected to
the space spanned by a <code>Splinets</code>-basis over a specific set of knots;
If the parameter is a <code>Splinets</code>-object containing <code>N</code> splines,
then it is orthogonally projected or represented in the basis that is specified by other parameters.
If the paramater is a matrix,
then it is treated as <code>N</code> piecewise constant functions with the arguments in the first column and the corresponding values of the functions in the remaining <code>N</code> columns.</p></dd>


<dt id="arg-knots">knots<a class="anchor" aria-label="anchor" href="#arg-knots"></a></dt>
<dd><p>vector, the knots of the projection space, together with <code>smorder</code> fully characterizes the projection space; This parameter is overridden by the SLOT <code>basis@knots</code> of the <code>basis</code> input if this one is not <code>NULL</code>.</p></dd>


<dt id="arg-smorder">smorder<a class="anchor" aria-label="anchor" href="#arg-smorder"></a></dt>
<dd><p>integer, the order of smoothness of the projection space; This parameter is overridden by  the SLOT <code>basis@smorder</code> of the <code>basis</code> input if this one is not <code>NULL</code>.</p></dd>


<dt id="arg-periodic">periodic<a class="anchor" aria-label="anchor" href="#arg-periodic"></a></dt>
<dd><p>logical, a flag to indicate if B-splines will be of periodic type or not; In the case of periodic splines, the arguments of the input and the knots need to be within [0,1] or, otherwise, an error occurs and a message advising the recentering and rescaling data is shown.</p></dd>


<dt id="arg-basis">basis<a class="anchor" aria-label="anchor" href="#arg-basis"></a></dt>
<dd><p><code>Splinets</code>-object, the basis used for the representation of the projection of the input <code>fdsp</code>;</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>string, the choice of the basis in the projection space used only if the <code>basis</code>-parameter is not given; The following choices are available</p><ul><li><p><code>'bs'</code> for the unorthogonalized B-splines,</p></li>
<li><p><code>'spnt'</code> for the orthogonal splinet (the default),</p></li>
<li><p><code>'gsob'</code> for the Gramm-Schmidt (one-sided) OB-splines,</p></li>
<li><p><code>'twob'</code> for the two-sided OB-splines.</p></li>
</ul><p>The default is <code>'spnt'</code>.</p></dd>


<dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>logical, indicator if the illustrative plots are to be produced:</p><ul><li><p>the splinet used in the projection(s) on the dyadic grid,</p></li>
<li><p>the coefficients of the projection(s) on the dyadic grid,</p></li>
<li><p>the input function(s),</p></li>
<li><p>the projection(s).</p></li>
</ul><p>;</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The value of the function is a list made of four elements</p><ul><li><p><code>project$input</code> – <code>fdsp</code>, when the input is a <code>Splinets</code>-object or a matrix with the first column in an increasing order,
  otherwise it is the input numeric matrix after ordering according to the first column,</p></li>
<li><p><code>project$coeff</code> – <code>N x (n-k+1)</code> matrix of the coefficients of representation of the projection of the input in the splinet basis,</p></li>
<li><p><code>project$basis</code> – the spline basis,</p></li>
<li><p><code>projedt$sp</code> – the <code>Splinets</code>-object containing the projected splines.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The obtained coefficients \(\mathbf A = (a_{ji})\) with respect to the basis allow to evaluate the splines \(S_j\) in the projection according to
$$
S_j=\sum_{i=1}^{n-k-1} a_{ji} OB_{i}, \,\, j=1,\dots, N,
 $$
where \(n\) is the number of the knots (including the endpoints), \(k\) is the spline smoothness order,
\(N\) is the number of the projected functions and  \(OB_i\)'s consitute the considered basis.
The coefficient for the splinet basis are always evaluated and thus, for example,
<code>PFD=project(FD,knots); ProjDataSplines=lincomb(PFD$coeff,PFD$basis)</code>
creates a <code>Splinets</code>-object made of the projections of the input functional data in <code>FD</code>.
If the input parameter <code>basis</code> is given, then the function utilizes this basis and does not
need to build it. However, if <code>basis</code> is the B-spline basis, then the B-spline orthogonalization is performed anyway,
thus the computational gain is smaller than in the case when <code>basis</code> is an orthogonal basis.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Liu, X., Nassar, H., Podg\(\mbox{\'o}\)rski, K. "Dyadic diagonalization of positive definite band matrices and efficient B-spline orthogonalization." Journal of Computational and Applied Mathematics (2022) &lt;https://doi.org/10.1016/j.cam.2022.114444&gt;.</p>

<p>Podg\(\mbox{\'o}\)rski, K. (2021)
"<code>Splinets</code> – splines through the Taylor expansion, their support sets and orthogonal bases." &lt;arXiv:2102.00733&gt;.</p>
<p>Nassar, H., Podg\(\mbox{\'o}\)rski, K. (2023) "Splinets 1.5.0 – Periodic Splinets." &lt;arXiv:2302.07552&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="refine.html">refine</a></code> for embeding a <code>Splinets</code>-object into the space of splines with an extended set of knots;
<code><a href="lincomb.html">lincomb</a></code> for evaluation of a linear combination of splines;
<code><a href="splinet.html">splinet</a></code> for obtaining the spline bases given the set of knots and the smootheness order;</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#-------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#----Representing splines in the spline bases-----#</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">3</span> <span class="co"># order</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">10</span> <span class="co"># number of the internal knots (excluding the endpoints)</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">S</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 does not satisfy the conditions </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           One of the reasons can be that SLOT 'taylor' is not correctly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.383861 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  has the derivative matrix corrected by the RRM method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  given that SLOT 'taylor' is properly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span> <span class="co"># plotting a spline</span></span></span>
<span class="r-plt img"><img src="project-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="va">spls</span><span class="op">=</span><span class="fu"><a href="rspline.html">rspline</a></span><span class="op">(</span><span class="va">spl</span>,<span class="fl">5</span><span class="op">)</span> <span class="co"># a random sample of splines</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Repr</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">spl</span><span class="op">)</span> <span class="co">#decomposition of splines into the splinet coefficients</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Repr</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">spl</span>, graph <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#decomposition of splines with the following graphs</span></span></span>
<span class="r-in"><span>                             <span class="co">#that illustrate the decomposition: </span></span></span>
<span class="r-in"><span>                             <span class="co"># 1) The orthogonal spine basis on the dyadic grid; </span></span></span>
<span class="r-in"><span>                             <span class="co"># 2) The coefficients of the projections on the dyadic grid;</span></span></span>
<span class="r-in"><span>                             <span class="co"># 3) The input splines;</span></span></span>
<span class="r-in"><span>                             <span class="co"># 4) The projections of the input.</span></span></span>
<span class="r-in"><span>                </span></span>
<span class="r-in"><span><span class="va">Repr</span><span class="op">$</span><span class="va">coeff</span>       <span class="co">#the coefficients of the decomposition</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]       [,3]     [,4]        [,5]       [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.1006816 -0.02484691 -0.1980802 -0.17089 -0.08691961 -0.2024501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,7]      [,8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.3437466 -0.124082</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Repr</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> <span class="co">#plot of the reconstruction of the spline</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spls</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Reprs</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">spls</span>,basis <span class="op">=</span> <span class="va">Repr</span><span class="op">$</span><span class="va">basis</span><span class="op">)</span> <span class="co">#decomposing splines using the available basis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Reprs</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Reprs2</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">spls</span>,type <span class="op">=</span> <span class="st">'gsob'</span><span class="op">)</span> <span class="co">#using the Gram-Schmidt basis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#The case of the regular non-normalized B-splines:</span></span></span>
<span class="r-in"><span><span class="va">Reprs3</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">spls</span>,type <span class="op">=</span> <span class="st">'bs'</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Reprs3</span><span class="op">$</span><span class="va">basis</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">Reprs3</span><span class="op">$</span><span class="va">basis</span>,norm_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#the B-splines follow the classical definition and </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.04357864 0.04357864 0.04357864 0.04357864 0.04357864 0.04357864 0.04357864</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.04357864</span>
<span class="r-in"><span>                                       <span class="co">#thus are not normalized</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spls</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Reprs3</span><span class="op">$</span><span class="va">basis</span><span class="op">)</span> <span class="co">#Bsplines</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Reprs3</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> <span class="co">#reconstruction using the B-splines and the decomposition</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#a non-equidistant example</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">10</span>; <span class="va">k</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>; <span class="va">xi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>; <span class="va">xi</span><span class="op">[</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span> </span></span>
<span class="r-in"><span><span class="va">S</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">S</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The spline 1 'ths highest derivative at the two central knots has been made equal by averaging SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The derivative matrix for spline 1 does not satisfy the smoothness conditions (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The standard error per matrix entry is 1.177526 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 2 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 2 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spls</span><span class="op">=</span><span class="fu"><a href="rspline.html">rspline</a></span><span class="op">(</span><span class="va">spl</span>,<span class="fl">5</span><span class="op">)</span> <span class="co"># a random sample of splines</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spls</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Reprs</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">spls</span>,type <span class="op">=</span> <span class="st">'twob'</span><span class="op">)</span> <span class="co">#decomposing using the two-sided orthogonalization</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Reprs</span><span class="op">$</span><span class="va">basis</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Reprs</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#The case of the regular non-normalized B-splines:</span></span></span>
<span class="r-in"><span><span class="va">Reprs2</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">spls</span>,basis<span class="op">=</span><span class="va">Reprs</span><span class="op">$</span><span class="va">basis</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Reprs2</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> <span class="co">#reconstruction using the B-splines and the decomposition</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#-----Projecting splines into a spline space------#</span></span></span>
<span class="r-in"><span><span class="co">#-------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">3</span> <span class="co"># order</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">10</span> <span class="co"># number of the internal knots (excluding the endpoints)</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">S</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 does not satisfy the conditions </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           One of the reasons can be that SLOT 'taylor' is not correctly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.383861 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  has the derivative matrix corrected by the RRM method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  given that SLOT 'taylor' is properly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span> <span class="co">#the spline</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">knots</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Prspl</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">spl</span>,<span class="va">knots</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The knots were not given in the strictly increasing order, which is required. The ordered knots with removed ties are replacing the input knot values.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Prspl</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> <span class="co">#the projection spline</span></span></span>
<span class="r-in"><span><span class="va">Rspl</span><span class="op">=</span><span class="fu"><a href="refine.html">refine</a></span><span class="op">(</span><span class="va">spl</span>,newknots <span class="op">=</span> <span class="va">knots</span><span class="op">)</span> <span class="co">#embedding the spline to the common space</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Rspl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">RPspl</span><span class="op">=</span><span class="fu"><a href="refine.html">refine</a></span><span class="op">(</span><span class="va">Prspl</span><span class="op">$</span><span class="va">sp</span>,newknots <span class="op">=</span> <span class="va">xi</span><span class="op">)</span>  <span class="co">#embedding the projection spline to the common space</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">RPspl</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">All</span><span class="op">=</span><span class="fu"><a href="gather.html">gather</a></span><span class="op">(</span><span class="va">RPspl</span>,<span class="va">Rspl</span><span class="op">)</span> <span class="co">#creating the Splinets-object with the spline and its projection</span></span></span>
<span class="r-in"><span><span class="va">Rbasis</span><span class="op">=</span><span class="fu"><a href="refine.html">refine</a></span><span class="op">(</span><span class="va">Prspl</span><span class="op">$</span><span class="va">basis</span>,newknots <span class="op">=</span> <span class="va">xi</span><span class="op">)</span> <span class="co">#embedding the basis to the common space</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Rbasis</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Res</span><span class="op">=</span><span class="fu"><a href="lincomb.html">lincomb</a></span><span class="op">(</span><span class="va">All</span>,<span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Res</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gramian.html">gramian</a></span><span class="op">(</span><span class="va">Res</span>,Sp2 <span class="op">=</span> <span class="va">Rbasis</span><span class="op">)</span> <span class="co">#the zero valued innerproducts -- the orthogonality of the residual spline</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]          [,2]          [,3]         [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -1.183883e-16 -4.617433e-16 -8.097876e-16 4.333287e-16</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spls</span><span class="op">=</span><span class="fu"><a href="rspline.html">rspline</a></span><span class="op">(</span><span class="va">spl</span>,<span class="fl">5</span><span class="op">)</span> <span class="co"># a random sample of splines</span></span></span>
<span class="r-in"><span><span class="va">Prspls</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">spls</span>,<span class="va">knots</span>,type<span class="op">=</span><span class="st">'bs'</span><span class="op">)</span> <span class="co">#projection in the B-spline representation</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The knots were not given in the strictly increasing order, which is required. The ordered knots with removed ties are replacing the input knot values.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spls</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">Prspls</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> <span class="co">#presenting projections on the common plot with the original splines</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Prspls</span><span class="op">$</span><span class="va">sp</span><span class="op">@</span><span class="va">knots</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.2344320 0.4557002 0.4724108 0.5744543 0.6254065 0.7207331 0.9202377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.9283003</span>
<span class="r-in"><span><span class="va">Prspls</span><span class="op">$</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Prspls</span><span class="op">$</span><span class="va">basis</span><span class="op">)</span>   <span class="co">#Bspline basis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#An example with partial support</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Bases</span><span class="op">=</span><span class="fu"><a href="splinet.html">splinet</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">BS_Two</span><span class="op">=</span><span class="fu"><a href="subsample.html">subsample</a></span><span class="op">(</span><span class="va">Bases</span><span class="op">$</span><span class="va">bs</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Bases</span><span class="op">$</span><span class="va">bs</span><span class="op">@</span><span class="va">der</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">BS_Two</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">A</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">2</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="lincomb.html">lincomb</a></span><span class="op">(</span><span class="va">BS_Two</span>,<span class="va">A</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">knots</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">13</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Prspl</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">spl</span>,<span class="va">knots</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The knots were not given in the strictly increasing order, which is required. The ordered knots with removed ties are replacing the input knot values.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Prspl</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Prspl</span><span class="op">$</span><span class="va">sp</span><span class="op">@</span><span class="va">knots</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.2304824 0.2505103 0.5214470 0.5321001 0.5742837 0.5957515 0.6999059</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8] 0.7039371 0.7107075 0.7107501 0.8330875 0.8375177 0.9653198</span>
<span class="r-in"><span><span class="va">Prspl</span><span class="op">$</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> list()</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Using explicit bases </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">3</span> <span class="co"># order</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">10</span> <span class="co"># number of the internal knots (excluding the endpoints)</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">S</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 does not satisfy the conditions </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           One of the reasons can be that SLOT 'taylor' is not correctly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.383861 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  has the derivative matrix corrected by the RRM method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  given that SLOT 'taylor' is properly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span><span class="va">spls</span><span class="op">=</span><span class="fu"><a href="rspline.html">rspline</a></span><span class="op">(</span><span class="va">spl</span>,<span class="fl">5</span><span class="op">)</span> <span class="co"># a random sample of splines</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spls</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">knots</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">base</span><span class="op">=</span><span class="fu"><a href="splinet.html">splinet</a></span><span class="op">(</span><span class="va">knots</span>,smorder<span class="op">=</span><span class="va">k</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots were not given in the strictly increasing order, which is required.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Ordered  knots with removed ties are replacing the input values.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">base</span><span class="op">$</span><span class="va">os</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Prsps</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">spls</span>,basis<span class="op">=</span><span class="va">base</span><span class="op">$</span><span class="va">os</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Prsps</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> <span class="co">#projection splines vs. the original splines</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">spls</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Projecting discretized data into a spline space----#</span></span></span>
<span class="r-in"><span><span class="co">#------------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">3</span>; <span class="va">n</span> <span class="op">=</span> <span class="fl">10</span>; <span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">S</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">S</span><span class="op">)</span>; <span class="va">spls</span><span class="op">=</span><span class="fu"><a href="rspline.html">rspline</a></span><span class="op">(</span><span class="va">spl</span>,<span class="fl">10</span><span class="op">)</span> <span class="co"># a random sample of splines</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The support sets for the splines are equal to the entire range of knots.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices are made in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 's highest derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 does not satisfy the conditions </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           One of the reasons can be that SLOT 'taylor' is not correctly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.383861 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  has the derivative matrix corrected by the RRM method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  given that SLOT 'taylor' is properly given.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">FData</span><span class="op">=</span><span class="fu"><a href="evspline.html">evspline</a></span><span class="op">(</span><span class="va">spls</span>,x<span class="op">=</span><span class="va">x</span><span class="op">)</span> <span class="co">#discrete functional data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">FData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">FData</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,pch<span class="op">=</span><span class="st">'.'</span>,cex<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>                   <span class="co">#adding small noise to the data</span></span></span>
<span class="r-in"><span><span class="va">noise</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">*</span><span class="fl">10</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">FData</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">/</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">FData</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="va">FData</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">noise</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">FData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">FData</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,pch<span class="op">=</span><span class="st">'.'</span>,cex<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">knots</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">DatProj</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">FData</span>,<span class="va">knots</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The knots were not given in the strictly increasing order, which is required. The ordered knots with removed ties are replacing the input knot values.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The input numerical data were not given in the increasing order.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  The data are ordered and returned in the ordered form as the first value in the output list.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The range of the input data is larger than the range of knots in the projection space.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The  7  values at the arguments outside the projection range will not affect the projection.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">DatProj</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> <span class="co">#the projections at the top of the original noised data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">DatProj</span><span class="op">$</span><span class="va">basis</span><span class="op">)</span> <span class="co">#the splinet in the problem</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Adding knots to the projection space so that all data points are included</span></span></span>
<span class="r-in"><span><span class="co">#in the range of the knots for the splinet basis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">knots</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.0</span>,<span class="fl">0.1</span>,<span class="fl">0.85</span>, <span class="fl">0.9</span>, <span class="fl">1.1</span>,<span class="va">knots</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bases</span><span class="op">=</span><span class="fu"><a href="splinet.html">splinet</a></span><span class="op">(</span><span class="va">knots</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Knots were not given in the strictly increasing order, which is required.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Ordered  knots with removed ties are replacing the input values.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">DatProj1</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">FData</span>,basis <span class="op">=</span> <span class="va">bases</span><span class="op">$</span><span class="va">os</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The input numerical data were not given in the increasing order.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  The data are ordered and returned in the ordered form as the first value in the output list.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">FData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">FData</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,pch<span class="op">=</span><span class="st">'.'</span>,cex<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">DatProj1</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Using the B-spline basis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">knots</span><span class="op">=</span><span class="va">xi</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">bases</span><span class="op">=</span><span class="fu"><a href="splinet.html">splinet</a></span><span class="op">(</span><span class="va">knots</span>,type<span class="op">=</span><span class="st">'bs'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">DatProj3</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">FData</span>,basis <span class="op">=</span> <span class="va">bases</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The input numerical data were not given in the increasing order.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  The data are ordered and returned in the ordered form as the first value in the output list.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">FData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">FData</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,pch<span class="op">=</span><span class="st">'.'</span>,cex<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">DatProj3</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">DatProj4</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">FData</span>,<span class="va">knots</span>,<span class="va">k</span>,type<span class="op">=</span><span class="st">'bs'</span><span class="op">)</span> <span class="co">#this includes building the base of order 4</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The input numerical data were not given in the increasing order.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  The data are ordered and returned in the ordered form as the first value in the output list.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">FData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">FData</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,pch<span class="op">=</span><span class="st">'.'</span>,cex<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">DatProj4</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">spls</span><span class="op">)</span> <span class="co">#overlying the functions that the original data were built from</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Using two-sided orthonormal basis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">DatProj5</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">FData</span>,<span class="va">knots</span>,type<span class="op">=</span><span class="st">'twob'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The input numerical data were not given in the increasing order.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  The data are ordered and returned in the ordered form as the first value in the output list.</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">FData</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,<span class="va">FData</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>,pch<span class="op">=</span><span class="st">'.'</span>,cex<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">DatProj5</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">spls</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#-----Projecting into a periodic spline space------#</span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#generating periodic splines</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">1</span><span class="co"># number of samples</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">N</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n_knots</span><span class="op">=</span><span class="fl">2</span><span class="op">^</span><span class="va">N</span><span class="op">*</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span> <span class="co">#the number of internal knots for the dyadic case</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n_knots</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span> <span class="op">=</span> <span class="fu"><a href="splinet.html">splinet</a></span><span class="op">(</span><span class="va">xi</span>,smorder <span class="op">=</span> <span class="va">k</span>, periodic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#The splinet basis</span></span></span>
<span class="r-in"><span><span class="va">stwo</span> <span class="op">=</span> <span class="fu"><a href="splinet.html">splinet</a></span><span class="op">(</span><span class="va">xi</span>,smorder <span class="op">=</span> <span class="va">k</span>,type<span class="op">=</span><span class="st">'twob'</span>, periodic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="co">#The two-sided orthogonal basis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">bs</span>,type<span class="op">=</span><span class="st">'dyadic'</span>,main<span class="op">=</span><span class="st">'B-Splines on dyadic structure'</span><span class="op">)</span> <span class="co">#B-splines on the dyadic graph </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stwo</span><span class="op">$</span><span class="va">os</span>,main<span class="op">=</span><span class="st">'Symmetric OB-Splines'</span><span class="op">)</span> <span class="co">#The two-sided orthogonal basis </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">stwo</span><span class="op">$</span><span class="va">os</span>,type<span class="op">=</span><span class="st">'dyadic'</span>,main<span class="op">=</span><span class="st">'Symmetric OB-Splines on dyadic structure'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># generating a periodic spline as a linear combination of the periodic splines </span></span></span>
<span class="r-in"><span><span class="va">A1</span><span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.7</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.8</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0.4</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">1</span>,<span class="fl">0</span>, <span class="fl">.5</span><span class="op">)</span>,nrow<span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">circular_spline</span><span class="op">=</span><span class="fu"><a href="lincomb.html">lincomb</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span>,<span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">A1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">circular_spline</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Graphical visualizations of the projections </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Pro_spline</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">circular_spline</span>,basis <span class="op">=</span> <span class="va">so</span><span class="op">$</span><span class="va">os</span>,graph <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Pro_spline</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#---------------------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---Projecting discretized data into a periodic spline space----#</span></span></span>
<span class="r-in"><span><span class="co">#---------------------------------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">nx</span><span class="op">=</span><span class="fl">100</span> <span class="co"># number of discritization </span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">1</span><span class="co"># number of samples</span></span></span>
<span class="r-in"><span><span class="va">k</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">N</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n_knots</span><span class="op">=</span><span class="fl">2</span><span class="op">^</span><span class="va">N</span><span class="op">*</span><span class="va">k</span><span class="op">-</span><span class="fl">1</span> <span class="co">#the number of internal knots for the dyadic case</span></span></span>
<span class="r-in"><span><span class="va">xi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="va">n_knots</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">so</span> <span class="op">=</span> <span class="fu"><a href="splinet.html">splinet</a></span><span class="op">(</span><span class="va">xi</span>,smorder <span class="op">=</span> <span class="va">k</span>, periodic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">hf</span><span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">nx</span> </span></span>
<span class="r-in"><span><span class="va">grid</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span> <span class="op">(</span><span class="va">hf</span> , <span class="fl">1</span>, by<span class="op">=</span><span class="va">hf</span><span class="op">)</span> <span class="co">#grid </span></span></span>
<span class="r-in"><span><span class="va">l</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">BB</span> <span class="op">=</span> <span class="fu"><a href="evspline.html">evspline</a></span><span class="op">(</span><span class="va">so</span><span class="op">$</span><span class="va">os</span>, x <span class="op">=</span><span class="va">grid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fbases</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">BB</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,<span class="va">BB</span><span class="op">[</span>,<span class="fl">5</span><span class="op">]</span>,<span class="va">BB</span><span class="op">[</span>,<span class="fl">9</span><span class="op">]</span>,<span class="va">BB</span><span class="op">[</span>,<span class="fl">13</span><span class="op">]</span>,<span class="va">BB</span><span class="op">[</span>,<span class="fl">17</span><span class="op">]</span>, <span class="va">BB</span><span class="op">[</span>,<span class="fl">23</span><span class="op">]</span>, <span class="va">BB</span><span class="op">[</span>,<span class="fl">25</span><span class="op">]</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">nx</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#constructing periodic data </span></span></span>
<span class="r-in"><span><span class="va">f_circular</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>,ncol<span class="op">=</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span>,nrow<span class="op">=</span><span class="va">nx</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lambda</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.7</span>,<span class="fl">0.8</span>,<span class="fl">0.4</span>, <span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">f_circular</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">=</span> <span class="va">BB</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">f_circular</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">=</span> <span class="va">fbases</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span><span class="va">lambda</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">f_circular</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">f_circular</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, type<span class="op">=</span><span class="st">'l'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">Pro</span><span class="op">=</span><span class="fu">project</span><span class="op">(</span><span class="va">f_circular</span>,basis <span class="op">=</span> <span class="va">so</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Pro</span><span class="op">$</span><span class="va">sp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Xijia Liu, Hiba Nassar, Krzysztof Podgorski.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

