<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Gramian matrix, norms, and inner products of splines — gramian • Splinets</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Gramian matrix, norms, and inner products of splines — gramian"><meta name="description" content="The function performs evaluation of the matrix of the inner products
\(\int S(t) \cdot T(t) dt \) of all the pairs of splines \(S\), \(T\) from the input object.
The program utilizes the Taylor expansion of splines, see the reference for details."><meta property="og:description" content="The function performs evaluation of the matrix of the inner products
\(\int S(t) \cdot T(t) dt \) of all the pairs of splines \(S\), \(T\) from the input object.
The program utilizes the Taylor expansion of splines, see the reference for details."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Splinets</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/FunctionalPrincipalValueDecomposition.html">Functional Principal Value Decomposition with the Wine data</a></li>
    <li><a class="dropdown-item" href="../articles/ImageClassification.html">Image Classification with Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/IntroductiontoSplinets.html">Introduction to Splinets</a></li>
    <li><a class="dropdown-item" href="../articles/MassSpectrometry.html">Splinets Statistical Application: mass spectrometry</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ranibasna/R-Splinets/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Gramian matrix, norms, and inner products of splines</h1>
      <small class="dont-index">Source: <a href="https://github.com/ranibasna/R-Splinets/blob/HEAD/R/fun_gramian.R" class="external-link"><code>R/fun_gramian.R</code></a></small>
      <div class="d-none name"><code>gramian.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function performs evaluation of the matrix of the inner products
\(\int S(t) \cdot T(t) dt \) of all the pairs of splines \(S\), \(T\) from the input object.
The program utilizes the Taylor expansion of splines, see the reference for details.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gramian</span><span class="op">(</span><span class="va">Sp</span>, norm_only <span class="op">=</span> <span class="cn">FALSE</span>, sID <span class="op">=</span> <span class="cn">NULL</span>, Sp2 <span class="op">=</span> <span class="cn">NULL</span>, s2ID <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-sp">Sp<a class="anchor" aria-label="anchor" href="#arg-sp"></a></dt>
<dd><p><code>Splinets</code> object;</p></dd>


<dt id="arg-norm-only">norm_only<a class="anchor" aria-label="anchor" href="#arg-norm-only"></a></dt>
<dd><p>logical, indicates if only the square norm of the
elements in the input object is calculated; The default is <code>norm_only=FALSE</code>;</p></dd>


<dt id="arg-sid">sID<a class="anchor" aria-label="anchor" href="#arg-sid"></a></dt>
<dd><p>vector of integers, the indicies specifying splines in the <code>Splinets</code>
list <code>Sp</code> to be evaluated; If <code>sID=NULL</code> (default), then the inner products for all the pairs taken from the object are evaluated.</p></dd>


<dt id="arg-sp-">Sp2<a class="anchor" aria-label="anchor" href="#arg-sp-"></a></dt>
<dd><p><code>Splinets</code> object, the optional second  <code>Splinets</code>-object; The inner products between
splines in <code>Sp</code> and in <code>Sp2</code> are evaluated, i.e. the cross-gramian matrix.</p></dd>


<dt id="arg-s-id">s2ID<a class="anchor" aria-label="anchor" href="#arg-s-id"></a></dt>
<dd><p>vector of integers, the indicies specifying splines in the <code>Sp2</code> to be considered in the cross-gramian;</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p><code>norm_only=FALSE</code> – the Gram matrix of inner products of the splines within the input <code>Splinets</code>-objects is returned,</p></li>
<li><p><code>Sp2 = NULL</code> – the non-negative definite matrix of the inner products of splines in <code>Sp</code> is returned,</p></li>
<li><p>both <code>Sp</code> and <code>Sp2</code> are non-<code>NULL</code> and contain splines \(S_i\)'s and \(T_j\)'s, respectively ==
the cross-gramian matris of the inner products for the pairs of splines \((S_i,T_j)\) is returned,</p></li>
<li><p><code>norm_only=FALSE</code>– the vector of the norms of <code>Sp</code> is returned.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If there is only one input <code>Splinet</code>-object, then the non-negative symmetrix matrix of the splines in this object is returned.
If there are two input <code>Splinet</code>-objects, then the \(m \times r\) matrix of the cross-inner product is returned, where \(m\) is
the number of splines in the first object and \(r\) is their number in the second one.
If only the norms are evaluated (<code>norm_only= TRUE</code>) it is always evaluating the norms of the first object.
In the case of two input <code>Splinets</code>-objects, they should be over the same set of knots and of the same smoothness order.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>


<p>Liu, X., Nassar, H., Podg\(\mbox{\'o}\)rski, K. "Dyadic diagonalization of positive definite band matrices and efficient B-spline orthogonalization." Journal of Computational and Applied Mathematics (2022) &lt;https://doi.org/10.1016/j.cam.2022.114444&gt;.</p>

<p>Podg\(\mbox{\'o}\)rski, K. (2021)
"<code>Splinets</code> – splines through the Taylor expansion, their support sets and orthogonal bases." &lt;arXiv:2102.00733&gt;.</p>
<p>Nassar, H., Podg\(\mbox{\'o}\)rski, K. (2023) "Splinets 1.5.0 – Periodic Splinets." &lt;arXiv:2302.07552&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="lincomb.html">lincomb</a></code> for evaluation of a linear combination of splines;
 <code><a href="project.html">project</a></code> for projections to the spaces of Splines;</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#---------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#---- Simple three splines example -----# </span></span></span>
<span class="r-in"><span><span class="co">#---------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">25</span>; <span class="va">k</span><span class="op">=</span><span class="fl">3</span></span></span>
<span class="r-in"><span><span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>; <span class="va">xi</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">=</span><span class="fl">0</span>; <span class="va">xi</span><span class="op">[</span><span class="va">n</span><span class="op">+</span><span class="fl">2</span><span class="op">]</span><span class="op">=</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="co">#Defining support ranges for three splines</span></span></span>
<span class="r-in"><span><span class="va">supp</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">12</span>,<span class="fl">4</span>,<span class="fl">20</span>,<span class="fl">6</span>,<span class="fl">25</span><span class="op">)</span>,byrow<span class="op">=</span><span class="cn">TRUE</span>,ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#Initial random matrices of the derivative for each spline</span></span></span>
<span class="r-in"><span><span class="va">SS1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">supp</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">supp</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">SS2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">supp</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">supp</span><span class="op">[</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">SS3</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">supp</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">supp</span><span class="op">[</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">SS1</span>,<span class="va">supp</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span><span class="op">)</span> <span class="co">#constructing the first correct spline</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 1 's highest derivative at the central knot is not zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Now it is set to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the splie conditions (up to the accuracy set in SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.418853 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span><span class="va">nspl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">SS2</span>,<span class="va">supp</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 1 's highest derivative at the central knot is not zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Now it is set to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the splie conditions (up to the accuracy set in SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.291063 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="gather.html">gather</a></span><span class="op">(</span><span class="va">spl</span>,<span class="va">nspl</span><span class="op">)</span> <span class="co">#the second and the first ones</span></span></span>
<span class="r-in"><span><span class="va">nspl</span><span class="op">=</span><span class="fu"><a href="construct.html">construct</a></span><span class="op">(</span><span class="va">xi</span>,<span class="va">k</span>,<span class="va">SS3</span>,<span class="va">supp</span><span class="op">[</span><span class="fl">3</span>,<span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using  method RRM to correct the derivative matrix entries.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 1  - highest derivative is not symmetric at the center (equal values at the two central knots).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The two values have been made equal by averaging.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the splie conditions (up to the accuracy set in SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.476759 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 2 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> There are less than 5 knots, the first 2 entries of the 5 nd row counting from the end in the input will be changed in the output.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix derivative is now corrected by method RRM .</span>
<span class="r-in"><span><span class="va">spl</span><span class="op">=</span><span class="fu"><a href="gather.html">gather</a></span><span class="op">(</span><span class="va">spl</span>,<span class="va">nspl</span><span class="op">)</span> <span class="co">#the third is added</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spl</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gramian-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">gramian</span><span class="op">(</span><span class="va">spl</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]        [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.6529948  0.24933900 -0.10598721</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.2493390  0.21677143 -0.02862501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.1059872 -0.02862501  0.43189486</span>
<span class="r-in"><span><span class="fu">gramian</span><span class="op">(</span><span class="va">spl</span>, norm_only <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6529948 0.2167714 0.4318949</span>
<span class="r-in"><span><span class="fu">gramian</span><span class="op">(</span><span class="va">spl</span>, sID <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.6529948 -0.1059872</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.1059872  0.4318949</span>
<span class="r-in"><span><span class="fu">gramian</span><span class="op">(</span><span class="va">spl</span>,sID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,Sp2<span class="op">=</span><span class="va">spl</span>,s2ID<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="co">#the cross-Gramian matrix  </span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.2493390</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.1059872</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#--- Example with varying support sets ---#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------#</span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">40</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>; <span class="va">k</span><span class="op">=</span><span class="fl">2</span>; </span></span>
<span class="r-in"><span><span class="va">support</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">9</span>,<span class="fl">15</span>,<span class="fl">24</span>,<span class="fl">30</span>,<span class="fl">37</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"Splinets"</span>,knots<span class="op">=</span><span class="va">xi</span>,smorder<span class="op">=</span><span class="va">k</span>,supp<span class="op">=</span><span class="va">support</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co">#the number of knots in the support</span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">der</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#the derivative matrix at random</span></span></span>
<span class="r-in"><span><span class="va">sp1</span> <span class="op">=</span> <span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="co">#the correction of 'der' matrices</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 2 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 3 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1  highest, support 1 's derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.613142 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 2 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1  highest, support 2 's derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 2  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.457952 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 2 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 3 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1  highest, support 3 's derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 3  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.458022 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 3 has the derivative matrix corrected by the RRM method.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">support</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">12</span>,<span class="fl">17</span>,<span class="fl">29</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"Splinets"</span>,knots<span class="op">=</span><span class="va">xi</span>,smorder<span class="op">=</span><span class="va">k</span>,supp<span class="op">=</span><span class="va">support</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co">#the number of knots in the support</span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">der</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#the derivative matrix at random</span></span></span>
<span class="r-in"><span><span class="va">sp2</span> <span class="op">=</span> <span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 2 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1  highest, support 1 's derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.546269 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 2 's highest derivative at the central knot is not equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 support 2 's highest derivative value at the central knot has been made equal to zero.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 2  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.853498 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 2 has the derivative matrix corrected by the RRM method.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spp</span> <span class="op">=</span> <span class="fu"><a href="gather.html">gather</a></span><span class="op">(</span><span class="va">sp1</span>,<span class="va">sp2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">support</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">10</span>,<span class="fl">14</span>,<span class="fl">21</span>,<span class="fl">27</span>,<span class="fl">34</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">2</span>,byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"Splinets"</span>,knots<span class="op">=</span><span class="va">xi</span>,smorder<span class="op">=</span><span class="va">k</span>,supp<span class="op">=</span><span class="va">support</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">-</span><span class="va">sp</span><span class="op">@</span><span class="va">supp</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span> <span class="co">#the number of knots in the support</span></span></span>
<span class="r-in"><span><span class="va">sp</span><span class="op">@</span><span class="va">der</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">m</span><span class="op">*</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,ncol<span class="op">=</span><span class="op">(</span><span class="va">k</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#the derivative matrix at random</span></span></span>
<span class="r-in"><span><span class="va">sp3</span> <span class="op">=</span> <span class="fu"><a href="is.splinets.html">is.splinets</a></span><span class="op">(</span><span class="va">sp</span><span class="op">)</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> DIAGNOSTIC CHECK of a SPLINETS object</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE SUPPORT SETS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> THE DERIVATIVES AT THE KNOTS:  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 1 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 2 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The boundary zero conditions are not satisfied for spline 1 in the input 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the first and last rows of the derivative matrices over the support component 3 of spline 1 in the output 'Splinets' object.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 1 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1  highest, support 1 's derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 1  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.432885 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 1 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 2 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1  highest, support 2 's derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 2  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 0.8928797 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 2 has the derivative matrix corrected by the RRM method.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1 , support 3 's highest derivative is not symmetrically defined at the center (the values at the two central knots should be equal).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spline 1  highest, support 3 's derivative values at the two central knots have been made equal by averaging the two central values in SLOT 'der'.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The matrix of derivatives at the knots for spline 1 , support 3  does not satisfy the conditions that are required for a spline (up to the accuracy SLOT 'epsilon').</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The computed standard error per matrix entry is 1.216008 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the LHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Correction of the RHS part of the matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The output object Spline 1  support 3 has the derivative matrix corrected by the RRM method.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spp</span> <span class="op">=</span> <span class="fu"><a href="gather.html">gather</a></span><span class="op">(</span><span class="va">spp</span>, <span class="va">sp3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spp</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gramian-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">gramian</span><span class="op">(</span><span class="va">spp</span><span class="op">)</span> <span class="co">#the regular gramian matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]         [,2]         [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.184674517 -0.035625141  0.002490996</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.035625141  0.250416141 -0.006716441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.002490996 -0.006716441  0.005898704</span>
<span class="r-in"><span><span class="va">spp2</span><span class="op">=</span><span class="fu"><a href="subsample.html">subsample</a></span><span class="op">(</span><span class="va">spp</span>,<span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,size<span class="op">=</span><span class="fl">3</span>,rep<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gramian</span><span class="op">(</span>Sp<span class="op">=</span><span class="va">spp</span>,Sp2<span class="op">=</span><span class="va">spp2</span><span class="op">)</span> <span class="co">#cross-Gramian matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]         [,2]         [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.035625141  0.184674517 -0.035625141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.250416141 -0.035625141  0.250416141</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.006716441  0.002490996 -0.006716441</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------#</span></span></span>
<span class="r-in"><span><span class="co">#--------- Grammian for B-splines --------#</span></span></span>
<span class="r-in"><span><span class="co">#-----------------------------------------#</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span><span class="op">=</span><span class="fl">25</span>; <span class="va">xi</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>; <span class="va">k</span><span class="op">=</span><span class="fl">2</span>; </span></span>
<span class="r-in"><span><span class="va">Sp</span><span class="op">=</span><span class="fu"><a href="splinet.html">splinet</a></span><span class="op">(</span><span class="va">xi</span><span class="op">)</span> <span class="co">#B-splines and corresponding splinet</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">gramian</span><span class="op">(</span><span class="va">Sp</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span> <span class="co">#band grammian matrix for B-splines</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,1]         [,2]         [,3]         [,4]         [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 1.843712e-02 9.088828e-03 9.157509e-04 7.631258e-06 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 9.088828e-03 1.843712e-02 9.088828e-03 9.157509e-04 7.631258e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 9.157509e-04 9.088828e-03 1.843712e-02 9.088828e-03 9.157509e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 7.631258e-06 9.157509e-04 9.088828e-03 1.843712e-02 9.088828e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.000000e+00 7.631258e-06 9.157509e-04 9.088828e-03 1.843712e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.000000e+00 0.000000e+00 7.631258e-06 9.157509e-04 9.088828e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.000000e+00 0.000000e+00 0.000000e+00 7.631258e-06 9.157509e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 7.631258e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,6]         [,7]         [,8]         [,9]        [,10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 7.631258e-06 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 9.157509e-04 7.631258e-06 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 9.088828e-03 9.157509e-04 7.631258e-06 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 1.843712e-02 9.088828e-03 9.157509e-04 7.631258e-06 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 9.088828e-03 1.843712e-02 9.088828e-03 9.157509e-04 7.631258e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 9.157509e-04 9.088828e-03 1.843712e-02 9.088828e-03 9.157509e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 7.631258e-06 9.157509e-04 9.088828e-03 1.843712e-02 9.088828e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.000000e+00 7.631258e-06 9.157509e-04 9.088828e-03 1.843712e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.000000e+00 0.000000e+00 7.631258e-06 9.157509e-04 9.088828e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.000000e+00 0.000000e+00 0.000000e+00 7.631258e-06 9.157509e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 7.631258e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,11]        [,12]        [,13]        [,14]        [,15]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 7.631258e-06 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 9.157509e-04 7.631258e-06 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 9.088828e-03 9.157509e-04 7.631258e-06 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 1.843712e-02 9.088828e-03 9.157509e-04 7.631258e-06 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 9.088828e-03 1.843712e-02 9.088828e-03 9.157509e-04 7.631258e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 9.157509e-04 9.088828e-03 1.843712e-02 9.088828e-03 9.157509e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 7.631258e-06 9.157509e-04 9.088828e-03 1.843712e-02 9.088828e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.000000e+00 7.631258e-06 9.157509e-04 9.088828e-03 1.843712e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 0.000000e+00 0.000000e+00 7.631258e-06 9.157509e-04 9.088828e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 0.000000e+00 0.000000e+00 0.000000e+00 7.631258e-06 9.157509e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 7.631258e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,16]        [,17]        [,18]        [,19]        [,20]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 7.631258e-06 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 9.157509e-04 7.631258e-06 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 9.088828e-03 9.157509e-04 7.631258e-06 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 1.843712e-02 9.088828e-03 9.157509e-04 7.631258e-06 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 9.088828e-03 1.843712e-02 9.088828e-03 9.157509e-04 7.631258e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 9.157509e-04 9.088828e-03 1.843712e-02 9.088828e-03 9.157509e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 7.631258e-06 9.157509e-04 9.088828e-03 1.843712e-02 9.088828e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 0.000000e+00 7.631258e-06 9.157509e-04 9.088828e-03 1.843712e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] 0.000000e+00 0.000000e+00 7.631258e-06 9.157509e-04 9.088828e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] 0.000000e+00 0.000000e+00 0.000000e+00 7.631258e-06 9.157509e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] 0.000000e+00 0.000000e+00 0.000000e+00 0.000000e+00 7.631258e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,21]        [,22]        [,23]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] 0.000000e+00 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] 7.631258e-06 0.000000e+00 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] 9.157509e-04 7.631258e-06 0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] 9.088828e-03 9.157509e-04 7.631258e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] 1.843712e-02 9.088828e-03 9.157509e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,] 9.088828e-03 1.843712e-02 9.088828e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] 9.157509e-04 9.088828e-03 1.843712e-02</span>
<span class="r-in"><span><span class="fu">gramian</span><span class="op">(</span><span class="va">Sp</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#diagonal gramian matrix for the splinet</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                [,1]          [,2]          [,3]          [,4]          [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  1.000000e+00 -5.596038e-16 -2.609887e-16 -3.798495e-16  1.043450e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -5.596038e-16  1.000000e+00  3.814427e-16  3.238809e-17  2.043698e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -2.609887e-16  3.814427e-16  1.000000e+00 -8.477328e-16  2.187079e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -3.798495e-16  3.238809e-17 -8.477328e-16  1.000000e+00 -5.761791e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  1.043450e-16  2.043698e-17  2.187079e-16 -5.761791e-16  1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  5.528522e-16 -3.188186e-17 -6.221949e-16  2.516825e-16 -5.536149e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,] -1.364130e-17 -8.591478e-19 -4.894808e-17  4.110375e-17 -2.269577e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -1.956173e-17  0.000000e+00  0.000000e+00  0.000000e+00  4.364782e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  1.077349e-17  0.000000e+00  0.000000e+00  0.000000e+00 -2.044905e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -2.139122e-18  0.000000e+00  0.000000e+00  0.000000e+00 -4.452504e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  4.329480e-18 -2.849605e-18 -6.941719e-19 -3.540586e-17 -2.260428e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  9.981672e-18 -3.958199e-18  1.834303e-17  4.468800e-18  6.018597e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] -1.629385e-19  8.843864e-20 -5.010109e-19  3.526881e-19 -3.690355e-19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                [,6]          [,7]          [,8]          [,9]         [,10]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  5.528522e-16 -1.364130e-17 -1.956173e-17  1.077349e-17 -2.139122e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -3.188186e-17 -8.591478e-19  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -6.221949e-16 -4.894808e-17  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  2.516825e-16  4.110375e-17  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -5.536149e-16 -2.269577e-17  4.364782e-18 -2.044905e-17 -4.452504e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  1.000000e+00  8.738147e-16 -3.272195e-16 -3.536276e-17 -2.791678e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  8.738147e-16  1.000000e+00 -4.017155e-16  7.103781e-16 -5.688212e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -3.272195e-16 -4.017155e-16  1.000000e+00  2.458533e-17  6.615055e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,] -3.536276e-17  7.103781e-16  2.458533e-17  1.000000e+00 -2.529704e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -2.791678e-17 -5.688212e-17  6.615055e-18 -2.529704e-16  1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] -2.718100e-16  3.025570e-16 -7.113632e-18  1.087077e-15 -1.400184e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  5.664200e-17 -1.267454e-16  2.024615e-17 -5.402578e-16  1.718297e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  7.937923e-19  6.642628e-18 -1.432033e-18 -4.806067e-17  2.298509e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,11]         [,12]         [,13]         [,14]         [,15]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  4.329480e-18  9.981672e-18 -1.629385e-19  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,] -2.849605e-18 -3.958199e-18  8.843864e-20  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,] -6.941719e-19  1.834303e-17 -5.010109e-19  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,] -3.540586e-17  4.468800e-18  3.526881e-19  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,] -2.260428e-17  6.018597e-18 -3.690355e-19  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,] -2.718100e-16  5.664200e-17  7.937923e-19  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  3.025570e-16 -1.267454e-16  6.642628e-18  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,] -7.113632e-18  2.024615e-17 -1.432033e-18  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  1.087077e-15 -5.402578e-16 -4.806067e-17  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,] -1.400184e-15  1.718297e-16  2.298509e-17  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  1.000000e+00 -2.437609e-15 -2.325477e-16 -6.938885e-18 -4.112178e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] -2.437609e-15  1.000000e+00  2.939043e-15 -4.150024e-16 -1.222252e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] -2.325477e-16  2.939043e-15  1.000000e+00 -8.767934e-16  6.588478e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,] -6.938885e-18 -4.150024e-16 -8.767934e-16  1.000000e+00 -2.688308e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,] -4.112178e-17 -1.222252e-15  6.588478e-16 -2.688308e-16  1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]  2.656958e-18  1.808320e-16 -5.469462e-17  3.040555e-17  1.118171e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] -8.969883e-18 -1.901868e-16  5.880429e-16 -2.095378e-16  5.041938e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]  2.507992e-17 -3.058981e-17 -5.969468e-16  1.088786e-16 -1.193167e-15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] -2.475485e-18 -3.164968e-17  3.786323e-17  5.088476e-18 -4.002665e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]  1.467867e-18  1.413369e-17 -2.797133e-17  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,] -1.771076e-18 -5.199643e-18  1.318362e-17  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]  4.003676e-20 -6.498330e-18  1.363294e-18  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] -1.340072e-18 -8.852469e-18  4.329480e-18  6.488259e-19  3.456399e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,16]         [,17]         [,18]         [,19]         [,20]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,]  2.656958e-18 -8.969883e-18  2.507992e-17 -2.475485e-18  1.467867e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,]  1.808320e-16 -1.901868e-16 -3.058981e-17 -3.164968e-17  1.413369e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,] -5.469462e-17  5.880429e-16 -5.969468e-16  3.786323e-17 -2.797133e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]  3.040555e-17 -2.095378e-16  1.088786e-16  5.088476e-18  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]  1.118171e-16  5.041938e-16 -1.193167e-15 -4.002665e-17  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]  1.000000e+00 -1.400200e-16  4.499366e-16 -1.099991e-17  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] -1.400200e-16  1.000000e+00 -1.283190e-15  1.478028e-16 -6.848967e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,]  4.499366e-16 -1.283190e-15  1.000000e+00 -8.073802e-16  5.054478e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,] -1.099991e-17  1.478028e-16 -8.073802e-16  1.000000e+00 -7.665030e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,]  0.000000e+00 -6.848967e-18  5.054478e-16 -7.665030e-16  1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]  0.000000e+00 -1.821870e-17 -1.161446e-15  5.200541e-16 -4.195039e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]  0.000000e+00 -1.176312e-17 -1.191137e-16  1.611974e-16 -2.649931e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,] -2.823535e-17  5.178255e-17 -9.062980e-16  2.074371e-16  1.269364e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               [,21]         [,22]         [,23]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1,]  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [2,]  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [3,]  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [4,]  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [5,]  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [6,]  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [7,]  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [8,]  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [9,]  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [10,]  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [11,] -1.771076e-18  4.003676e-20 -1.340072e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [12,] -5.199643e-18 -6.498330e-18 -8.852469e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [13,]  1.318362e-17  1.363294e-18  4.329480e-18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [14,]  0.000000e+00  0.000000e+00  6.488259e-19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [15,]  0.000000e+00  0.000000e+00  3.456399e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [16,]  0.000000e+00  0.000000e+00 -2.823535e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [17,] -1.821870e-17 -1.176312e-17  5.178255e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [18,] -1.161446e-15 -1.191137e-16 -9.062980e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [19,]  5.200541e-16  1.611974e-16  2.074371e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [20,] -4.195039e-16 -2.649931e-16  1.269364e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [21,]  1.000000e+00  1.118171e-16  8.650947e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [22,]  1.118171e-16  1.000000e+00 -2.661877e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [23,]  8.650947e-16 -2.661877e-16  1.000000e+00</span>
<span class="r-in"><span><span class="va">A</span><span class="op">=</span><span class="fu">gramian</span><span class="op">(</span>Sp<span class="op">=</span><span class="va">Sp</span><span class="op">$</span><span class="va">bs</span>,Sp2<span class="op">=</span><span class="va">Sp</span><span class="op">$</span><span class="va">os</span><span class="op">)</span> <span class="co">#cross-Gramian matrix, the coefficients of</span></span></span>
<span class="r-in"><span>                              <span class="co">#the decomposition of the B-splines</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Sp</span><span class="op">$</span><span class="va">bs</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gramian-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="lincomb.html">lincomb</a></span><span class="op">(</span><span class="va">Sp</span><span class="op">$</span><span class="va">os</span>,<span class="va">A</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gramian-4.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Rani Basna, Xijia Liu, Hiba Nassar, Krzysztof Podgorski, Hanqing Wu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

